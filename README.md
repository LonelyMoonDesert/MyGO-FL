# 基于拓扑对齐的联邦学习实验

这个项目实现了一个基于拓扑对齐的联邦学习实验，用于研究如何利用持续同调来改善联邦学习在非独立同分布(non-IID)数据上的性能。

## 项目结构

- `topo_data.py`: 包含数据生成和可视化相关的代码
- `topo_fed.py`: 实现联邦学习模型和拓扑对齐算法
- `requirements.txt`: 项目依赖
- `README.md`: 项目说明文档

## 安装依赖

```bash
pip install -r requirements.txt
```

## 运行实验

```bash
python topo_fed.py
```

## 实验说明

本实验使用合成数据集来展示拓扑对齐的效果。数据集具有以下特点：

1. 每个客户端的数据具有不同的拓扑结构：
   - 客户端1：环形数据
   - 客户端2：双环形数据
   - 客户端3：螺旋数据
   - 客户端4：双螺旋数据

2. 实验过程中会生成以下可视化结果：
   - 每个客户端的原始数据分布
   - 训练过程中的拓扑结构变化
   - 损失函数和拓扑距离的变化趋势

## 主要功能

1. 数据生成与可视化
   - 生成具有不同拓扑结构的合成数据
   - 使用t-SNE进行降维可视化
   - 计算并可视化持续同调图

2. 联邦学习实现
   - 基于FedAvg的模型聚合
   - 拓扑对齐损失的计算
   - 客户端本地训练

3. 实验监控
   - 训练损失记录
   - 拓扑距离计算
   - 可视化训练进度

## 实验结果

运行实验后，将在当前目录生成以下文件：

- `client_X_round_Y.png`: 第Y轮训练后客户端X的拓扑结构可视化
- `training_progress.png`: 训练过程中的损失和拓扑距离变化

## 注意事项

1. 确保安装了所有必要的依赖包
2. 实验可能需要较长时间运行，特别是在计算持续同调时
3. 可以通过修改`topo_fed.py`中的参数来调整实验设置

## 拓扑联邦学习实验说明

本项目实现了一个基于拓扑对齐的联邦学习实验，用于研究如何利用持续同调来改善联邦学习在非独立同分布(non-IID)数据上的性能。

### 实验特点

1. 数据集设计：
   - 使用合成数据集，每个客户端具有不同的拓扑结构
   - 客户端1：环形数据（1维同调群）
   - 客户端2：双环形数据（2个1维同调群）
   - 客户端3：螺旋数据（1维同调群，但形状不同）
   - 客户端4：双螺旋数据（2个1维同调群，但形状不同）

2. 模型架构：
   - 使用简单的神经网络作为特征提取器
   - 包含特征提取层和分类层
   - 特征提取层输出64维特征向量

3. 拓扑对齐策略：
   - 使用持续同调计算每个客户端特征空间的拓扑结构
   - 通过Wasserstein距离度量拓扑差异
   - 在训练过程中加入拓扑对齐损失

4. 可视化方案：
   - 使用t-SNE降维展示特征空间分布
   - 绘制持续同调图显示拓扑结构
   - 记录并可视化训练过程中的拓扑距离变化

### 参数调整

您可以通过修改`topo_fed.py`中的以下参数来调整实验：

- `n_clients`：客户端数量（默认：4）
- `n_rounds`：联邦学习轮数（默认：10）
- `n_epochs`：每轮本地训练的轮数（默认：5）
- `batch_size`：批次大小（默认：32）
- `lr`：学习率（默认：0.01）
- `lambda_topo`：拓扑对齐损失的权重（默认：0.1）

### 实验结果

实验将生成以下可视化结果：

1. 每个客户端的原始数据分布图
2. 训练过程中每个客户端的特征空间拓扑结构变化
3. 训练损失和拓扑距离的变化趋势图

这些可视化结果将帮助我们理解：
- 不同客户端数据的拓扑结构差异
- 拓扑对齐如何影响特征空间的结构
- 训练过程中拓扑结构的演化
