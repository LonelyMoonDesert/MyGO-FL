import pandas as pd
import matplotlib.pyplot as plt

# FedAvg 数据
# FedAvg 数据
fedavg_data = {
    'network': [0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4,
                0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4,
                0, 1, 2, 3, 4, 0, 1, 2, 3, 4],
    'round': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5,
              6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9],
    'pre_training_train_acc': [0, 0, 0, 0, 0, 0.099, 0.1099, 0.114, 0.1285, 0.1126, 0.3574, 0.3839, 0.4441, 0.4163, 0.3067,
                               0.4926, 0.5263, 0.5842, 0.4168, 0.2763, 0.5223, 0.5601, 0.6206, 0.4696, 0.3199, 0.5662, 0.6058,
                               0.6588, 0.4518, 0.2962, 0.6044, 0.6396, 0.6798, 0.4914, 0.3008, 0.6029, 0.6473, 0.6783, 0.4803,
                               0.2722, 0.627, 0.6623, 0.691, 0.5017, 0.2793, 0.6114, 0.6612, 0.7169, 0.5041, 0.2771],
    'pre_training_test_acc': [0, 0, 0, 0, 0, 0.1025, 0.1025, 0.1025, 0.1025, 0.1025, 0.3811, 0.3811, 0.3811, 0.3811, 0.3811,
                              0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5426, 0.5426, 0.5426, 0.5426, 0.5426, 0.5859, 0.5859,
                              0.5859, 0.5859, 0.5859, 0.6179, 0.6179, 0.6179, 0.6179, 0.6179, 0.6166, 0.6166, 0.6166, 0.6166,
                              0.6166, 0.6394, 0.6394, 0.6394, 0.6394, 0.6394, 0.6162, 0.6162, 0.6162, 0.6162, 0.6162],
    'training_train_acc': [0.6005, 0.5422, 0.4512, 0.4366, 0.3688, 0.5805, 0.6113, 0.5266, 0.477, 0.4673, 0.672, 0.6123,
                           0.5722, 0.5185, 0.4914, 0.7552, 0.702, 0.6117, 0.5521, 0.5265, 0.7936, 0.7163, 0.6472, 0.5268,
                           0.5317, 0.8073, 0.7776, 0.659, 0.6174, 0.5515, 0.8186, 0.758, 0.6716, 0.6048, 0.5546, 0.8491,
                           0.7759, 0.7013, 0.6197, 0.5458, 0.8531, 0.7792, 0.7167, 0.6298, 0.5988, 0.8405, 0.813, 0.709,
                           0.6587, 0.587],
    'training_test_acc': [0.5821, 0.5172, 0.3753, 0.3647, 0.2835, 0.5671, 0.5696, 0.3848, 0.3345, 0.3427, 0.6531, 0.6209,
                          0.4824, 0.4169, 0.3867, 0.7176, 0.6121, 0.5097, 0.4388, 0.4372, 0.7274, 0.6287, 0.5695, 0.4353,
                          0.4421, 0.7415, 0.6753, 0.6249, 0.477, 0.4374, 0.7533, 0.6694, 0.5705, 0.4538, 0.4482, 0.779,
                          0.7031, 0.5848, 0.4931, 0.5188, 0.7713, 0.658, 0.5555, 0.5042, 0.4644, 0.7685, 0.7148, 0.6077,
                          0.5342, 0.4419]
}

# FedAFG 数据
fedafg_data = {
    'network': [0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4,
                0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4,
                0, 1, 2, 3, 4, 0, 1, 2, 3, 4],
    'round': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5,
              6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9],
    'pre_training_train_acc': [0, 0, 0, 0, 0, 0.1003, 0.1142, 0.1091, 0.1118, 0.096, 0.3388, 0.3684, 0.3952, 0.4024, 0.2973,
                               0.4134, 0.4425, 0.4686, 0.4145, 0.3019, 0.4563, 0.4966, 0.5244, 0.469, 0.3386, 0.4723, 0.5087,
                               0.5473, 0.3597, 0.2613, 0.5055, 0.5482, 0.5757, 0.3882, 0.2693, 0.4964, 0.5391, 0.5627, 0.3915,
                               0.2673, 0.4997, 0.5365, 0.5646, 0.3971, 0.2685],
    'pre_training_test_acc': [0, 0, 0, 0, 0, 0.0989, 0.0989, 0.0989, 0.0989, 0.0989, 0.3523, 0.3523, 0.3523, 0.3523, 0.3523,
                              0.5152, 0.5152, 0.5152, 0.5152, 0.5152, 0.5434, 0.5434, 0.5434, 0.5434, 0.5434, 0.5774, 0.5774,
                              0.5774, 0.5774, 0.5774, 0.6059, 0.6059, 0.6059, 0.6059, 0.6059, 0.5984, 0.5984, 0.5984, 0.5984,
                              0.5984, 0.6236, 0.6236, 0.6236, 0.6236, 0.6236, 0.5983, 0.5983, 0.5983, 0.5983, 0.5983],
    'training_train_acc': [0.5969, 0.5401, 0.4592, 0.4415, 0.3815, 0.5766, 0.6079, 0.5202, 0.4716, 0.4592, 0.6544, 0.6023,
                           0.5619, 0.5065, 0.4793, 0.7348, 0.6823, 0.5993, 0.5429, 0.5133, 0.7743, 0.7071, 0.6432, 0.5136,
                           0.5227, 0.7825, 0.7542, 0.6476, 0.6171, 0.5591, 0.7914, 0.7335, 0.6525, 0.6125, 0.5504, 0.8245,
                           0.7488, 0.6764, 0.6036, 0.5326, 0.8285, 0.7544, 0.6936, 0.6169, 0.5856, 0.8099, 0.7842, 0.6803,
                           0.6288, 0.5557],
    'training_test_acc': [0.5903, 0.5225, 0.3815, 0.3699, 0.2914, 0.5736, 0.577, 0.3892, 0.3371, 0.3421, 0.6413, 0.6129,
                          0.4826, 0.4132, 0.3821, 0.7133, 0.6165, 0.5103, 0.4399, 0.438, 0.7176, 0.6319, 0.5735, 0.4384,
                          0.4443, 0.7351, 0.6703, 0.6178, 0.4758, 0.436, 0.7471, 0.669, 0.5721, 0.4541, 0.4486, 0.769,
                          0.7033, 0.5832, 0.492, 0.5181, 0.7659, 0.6612, 0.5596, 0.5079, 0.4673, 0.7645, 0.7108, 0.6038,
                          0.5302, 0.4381]
}
# 打印每个字段的长度
print("FedAvg Data Lengths:")
for key, value in fedavg_data.items():
    print(f"{key}: {len(value)}")

print("\nFedAFG Data Lengths:")
for key, value in fedafg_data.items():
    print(f"{key}: {len(value)}")# 数据处理：将数据转换为 DataFrame

fedavg_df = pd.DataFrame(fedavg_data)
fedafg_df = pd.DataFrame(fedafg_data)

# 计算训练精度和测试精度变化
fedavg_df['train_acc_diff'] = fedavg_df['training_train_acc'] - fedavg_df['pre_training_train_acc']
fedavg_df['test_acc_diff'] = fedavg_df['training_test_acc'] - fedavg_df['pre_training_test_acc']

fedafg_df['train_acc_diff'] = fedafg_df['training_train_acc'] - fedafg_df['pre_training_train_acc']
fedafg_df['test_acc_diff'] = fedafg_df['training_test_acc'] - fedafg_df['pre_training_test_acc']

# 绘制对比图
plt.figure(figsize=(10, 6))
plt.plot(fedavg_df['round'], fedavg_df['test_acc_diff'], label='FedAvg Test Acc Diff', marker='o', color='b')
plt.plot(fedafg_df['round'], fedafg_df['test_acc_diff'], label='FedAFG Test Acc Diff', marker='x', color='r')
plt.xlabel('Round')
plt.ylabel('Test Accuracy Difference')
plt.title('Comparison of Test Accuracy Difference: FedAvg vs. FedAFG')
plt.legend()
plt.grid(True)
plt.show()
