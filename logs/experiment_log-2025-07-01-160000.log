07-01 16:00 INFO     Namespace(model='resnet18', resume=True, ckpt_dir='./checkpoints', dataset='cifar10', net_config=None, partition='noniid-labeldir', batch_size=32, lr=0.01, lr_G=0.008, lr_D=0.008, epochs=5, epoch_G=5, epoch_D=1, n_parties=5, alg='fedtopo', training_type='local', use_projection_head=False, out_dim=256, loss='contrastive', temperature=0.5, comm_round=10, is_same_initial=1, init_seed=0, dropout_p=0.0, datadir='../data', reg=1e-05, l1_lambda=0.0001, l1=False, adv_l1_lambda=0.0001, adv_l1=False, lambda_adv=0.3, logdir='./logs/', modeldir='./models/', beta=0.5, device='cuda:0', log_file_name='experiment_log-2025-07-01-160000', optimizer='sgd', optimizer_G='sgd', optimizer_D='sgd', mu=0.01, noise=0.0, noise_type='level', rho=0.9, sample=1.0, scheduler='StepLR', scheduler_g='StepLR', scheduler_d='StepLR', gamma=0.01, step_size=30, milestones='30,60', T_max=50, factor=0.1, patience=10, base_lr=0.001, max_lr=0.01, step_size_up=2000, steps_per_epoch=1000)
07-01 16:00 INFO     cuda:0
07-01 16:00 INFO     ####################################################################################################
07-01 16:00 INFO     Partitioning data
07-01 16:00 INFO     Data statistics: {0: {0: 2538, 1: 2206, 2: 409, 3: 3154, 4: 40, 5: 178, 6: 387, 7: 128, 8: 2363}, 1: {0: 43, 1: 215, 2: 202, 3: 1423, 4: 1777, 5: 2276, 6: 1, 7: 498, 8: 446, 9: 878}, 2: {0: 23, 1: 1517, 2: 1244, 3: 192, 4: 2349, 5: 208, 6: 259, 7: 2175, 8: 682, 9: 114}, 3: {0: 1053, 1: 1004, 2: 2473, 4: 108, 5: 512, 6: 897, 7: 1057, 8: 1368, 9: 2583}, 4: {0: 1343, 1: 58, 2: 672, 3: 231, 4: 726, 5: 1826, 6: 3456, 7: 1142, 8: 141, 9: 1425}}
07-01 16:00 INFO     Getting global dataset using get_dataloader.
07-01 16:00 INFO     Initializing nets
07-01 16:00 INFO     in comm round:0
07-01 16:00 INFO     Training network 0. n_training: 11403
07-01 16:00 INFO     Training network 0
07-01 16:00 INFO     >> Pre-Training Training accuracy: 0.0
07-01 16:00 INFO     >> Pre-Training Test accuracy: 0.0
07-01 16:01 INFO     Epoch: 0 Total Loss: 1.491017 Loss: 1.440561 Topo Loss: 1.009121
07-01 16:01 INFO     Epoch: 1 Total Loss: 1.109313 Loss: 1.059131 Topo Loss: 1.003622
07-01 16:02 INFO     Epoch: 2 Total Loss: 1.002467 Loss: 0.952141 Topo Loss: 1.006527
07-01 16:02 INFO     Epoch: 3 Total Loss: 0.895806 Loss: 0.845318 Topo Loss: 1.009770
07-01 16:02 INFO     Epoch: 4 Total Loss: 0.831436 Loss: 0.781021 Topo Loss: 1.008308
07-01 16:02 INFO     >> Training accuracy: 0.769096
07-01 16:02 INFO     >> Test accuracy: 0.362100
07-01 16:02 INFO      ** Training complete **
07-01 16:02 INFO     >> Similarity 0.0818
07-01 16:02 INFO     >> Entropy: 6.873387
07-01 16:02 INFO     net 0 final test acc 0.362100
07-01 16:02 INFO     Training network 1. n_training: 7759
07-01 16:02 INFO     Training network 1
07-01 16:03 INFO     >> Pre-Training Training accuracy: 0.0
07-01 16:03 INFO     >> Pre-Training Test accuracy: 0.0
07-01 16:03 INFO     Epoch: 0 Total Loss: 1.810220 Loss: 1.759836 Topo Loss: 1.007672
07-01 16:03 INFO     Epoch: 1 Total Loss: 1.472024 Loss: 1.421612 Topo Loss: 1.008255
07-01 16:03 INFO     Epoch: 2 Total Loss: 1.320585 Loss: 1.269996 Topo Loss: 1.011787
07-01 16:03 INFO     Epoch: 3 Total Loss: 1.268760 Loss: 1.217977 Topo Loss: 1.015661
07-01 16:04 INFO     Epoch: 4 Total Loss: 1.161013 Loss: 1.110716 Topo Loss: 1.005927
07-01 16:04 INFO     >> Training accuracy: 0.643511
07-01 16:04 INFO     >> Test accuracy: 0.422700
07-01 16:04 INFO      ** Training complete **
07-01 16:04 INFO     >> Similarity 0.0906
07-01 16:04 INFO     >> Entropy: 6.880278
07-01 16:04 INFO     net 1 final test acc 0.422700
07-01 16:04 INFO     Training network 2. n_training: 8763
07-01 16:04 INFO     Training network 2
07-01 16:04 INFO     >> Pre-Training Training accuracy: 0.0
07-01 16:04 INFO     >> Pre-Training Test accuracy: 0.0
07-01 16:04 INFO     Epoch: 0 Total Loss: 1.737062 Loss: 1.686745 Topo Loss: 1.006336
07-01 16:05 INFO     Epoch: 1 Total Loss: 1.377378 Loss: 1.326871 Topo Loss: 1.010133
07-01 16:05 INFO     Epoch: 2 Total Loss: 1.229403 Loss: 1.178860 Topo Loss: 1.010865
07-01 16:05 INFO     Epoch: 3 Total Loss: 1.128093 Loss: 1.077460 Topo Loss: 1.012677
07-01 16:05 INFO     Epoch: 4 Total Loss: 1.012348 Loss: 0.962123 Topo Loss: 1.004492
07-01 16:05 INFO     >> Training accuracy: 0.685496
07-01 16:05 INFO     >> Test accuracy: 0.423700
07-01 16:05 INFO      ** Training complete **
07-01 16:05 INFO     >> Similarity -0.0091
07-01 16:05 INFO     >> Entropy: 6.881016
07-01 16:05 INFO     net 2 final test acc 0.423700
07-01 16:05 INFO     Training network 3. n_training: 11055
07-01 16:05 INFO     Training network 3
07-01 16:06 INFO     >> Pre-Training Training accuracy: 0.0
07-01 16:06 INFO     >> Pre-Training Test accuracy: 0.0
07-01 16:06 INFO     Epoch: 0 Total Loss: 1.794968 Loss: 1.744657 Topo Loss: 1.006230
07-01 16:06 INFO     Epoch: 1 Total Loss: 1.313276 Loss: 1.262802 Topo Loss: 1.009481
07-01 16:07 INFO     Epoch: 2 Total Loss: 1.125362 Loss: 1.074654 Topo Loss: 1.014172
07-01 16:07 INFO     Epoch: 3 Total Loss: 0.973112 Loss: 0.922462 Topo Loss: 1.013015
07-01 16:07 INFO     Epoch: 4 Total Loss: 0.883269 Loss: 0.833024 Topo Loss: 1.004896
07-01 16:07 INFO     >> Training accuracy: 0.687200
07-01 16:07 INFO     >> Test accuracy: 0.511800
07-01 16:07 INFO      ** Training complete **
07-01 16:07 INFO     >> Similarity 0.0843
07-01 16:07 INFO     >> Entropy: 6.876264
07-01 16:07 INFO     net 3 final test acc 0.511800
07-01 16:07 INFO     Training network 4. n_training: 11020
07-01 16:07 INFO     Training network 4
07-01 16:08 INFO     >> Pre-Training Training accuracy: 0.0
07-01 16:08 INFO     >> Pre-Training Test accuracy: 0.0
07-01 16:08 INFO     Epoch: 0 Total Loss: 1.775270 Loss: 1.724761 Topo Loss: 1.010162
07-01 16:08 INFO     Epoch: 1 Total Loss: 1.347368 Loss: 1.296835 Topo Loss: 1.010668
07-01 16:09 INFO     Epoch: 2 Total Loss: 1.169369 Loss: 1.118931 Topo Loss: 1.008758
07-01 16:09 INFO     Epoch: 3 Total Loss: 1.072727 Loss: 1.022226 Topo Loss: 1.010024
07-01 16:09 INFO     Epoch: 4 Total Loss: 0.971835 Loss: 0.921561 Topo Loss: 1.005487
07-01 16:09 INFO     >> Training accuracy: 0.688657
07-01 16:09 INFO     >> Test accuracy: 0.409800
07-01 16:09 INFO      ** Training complete **
07-01 16:09 INFO     >> Similarity 0.0943
07-01 16:09 INFO     >> Entropy: 6.880687
07-01 16:09 INFO     net 4 final test acc 0.409800
07-01 16:09 INFO     global n_training: 1563
07-01 16:09 INFO     global n_test: 313
07-01 16:10 INFO     >> Global Model Train accuracy: 0.100160
07-01 16:10 INFO     >> Global Model Test accuracy: 0.100400
07-01 16:10 INFO     >> Global Model Entropy: 6.883662
07-01 16:10 INFO     in comm round:1
07-01 16:10 INFO     Training network 0. n_training: 11403
07-01 16:10 INFO     Training network 0
07-01 16:11 INFO     >> Pre-Training Training accuracy: 0.036306235201262825
07-01 16:11 INFO     >> Pre-Training Test accuracy: 0.1004
07-01 16:11 INFO     Epoch: 0 Total Loss: 1.039956 Loss: 0.990063 Topo Loss: 0.997858
07-01 16:11 INFO     Epoch: 1 Total Loss: 0.844542 Loss: 0.794793 Topo Loss: 0.994978
07-01 16:12 INFO     Epoch: 2 Total Loss: 0.743205 Loss: 0.693594 Topo Loss: 0.992216
07-01 16:12 INFO     Epoch: 3 Total Loss: 0.673410 Loss: 0.623399 Topo Loss: 1.000205
07-01 16:12 INFO     Epoch: 4 Total Loss: 0.641833 Loss: 0.592077 Topo Loss: 0.995132
07-01 16:13 INFO     >> Training accuracy: 0.811190
07-01 16:13 INFO     >> Test accuracy: 0.416100
07-01 16:13 INFO      ** Training complete **
07-01 16:13 INFO     >> Similarity -0.0274
07-01 16:13 INFO     >> Entropy: 6.883187
07-01 16:13 INFO     net 0 final test acc 0.416100
07-01 16:13 INFO     Training network 1. n_training: 7759
07-01 16:13 INFO     Training network 1
07-01 16:13 INFO     >> Pre-Training Training accuracy: 0.02603428276839799
07-01 16:13 INFO     >> Pre-Training Test accuracy: 0.1004
07-01 16:13 INFO     Epoch: 0 Total Loss: 1.392984 Loss: 1.343027 Topo Loss: 0.999124
07-01 16:13 INFO     Epoch: 1 Total Loss: 1.194757 Loss: 1.145047 Topo Loss: 0.994193
07-01 16:14 INFO     Epoch: 2 Total Loss: 1.094673 Loss: 1.044856 Topo Loss: 0.996340
07-01 16:14 INFO     Epoch: 3 Total Loss: 1.016211 Loss: 0.966129 Topo Loss: 1.001644
07-01 16:14 INFO     Epoch: 4 Total Loss: 0.950188 Loss: 0.900450 Topo Loss: 0.994762
07-01 16:15 INFO     >> Training accuracy: 0.688104
07-01 16:15 INFO     >> Test accuracy: 0.460300
