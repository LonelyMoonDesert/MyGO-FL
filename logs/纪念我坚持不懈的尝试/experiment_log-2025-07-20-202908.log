07-20 20:29 INFO     Namespace(model='resnet18', resume=True, ckpt_dir='./checkpoints', dataset='cifar10', net_config=None, partition='iid-diff-quantity', batch_size=32, lr=0.01, lr_G=0.008, lr_D=0.008, epochs=5, epoch_G=5, epoch_D=1, n_parties=5, alg='fedtopo', training_type='local', use_projection_head=False, out_dim=256, loss='contrastive', temperature=0.5, comm_round=10, is_same_initial=1, init_seed=0, dropout_p=0.0, datadir='../data/', reg=1e-05, l1_lambda=0.0001, l1=False, adv_l1_lambda=0.0001, adv_l1=False, lambda_adv=0.3, logdir='./logs/', modeldir='./models/', beta=0.5, device='cuda:0', log_file_name='experiment_log-2025-07-20-202908', optimizer='sgd', optimizer_G='sgd', optimizer_D='sgd', mu=0.01, noise=0.0, noise_type='level', rho=0.9, sample=1.0, scheduler='StepLR', scheduler_g='StepLR', scheduler_d='StepLR', gamma=0.01, step_size=30, milestones='30,60', T_max=50, factor=0.1, patience=10, base_lr=0.001, max_lr=0.01, step_size_up=2000, steps_per_epoch=1000, feature_layer='conv1', max_samples=1000, umap_dim=3, n_umap_batches=4)
07-20 20:29 INFO     cuda:0
07-20 20:29 INFO     ####################################################################################################
07-20 20:29 INFO     Partitioning data
07-20 20:29 INFO     Data statistics: {0: {0: 1954, 1: 1966, 2: 1962, 3: 1953, 4: 1966, 5: 1941, 6: 1921, 7: 1967, 8: 1952, 9: 2026}, 1: {0: 17, 1: 17, 2: 8, 3: 18, 4: 14, 5: 13, 6: 11, 7: 9, 8: 8, 9: 8}, 2: {0: 94, 1: 99, 2: 96, 3: 81, 4: 83, 5: 76, 6: 79, 7: 86, 8: 81, 9: 103}, 3: {0: 1570, 1: 1505, 2: 1565, 3: 1523, 4: 1544, 5: 1544, 6: 1605, 7: 1564, 8: 1514, 9: 1537}, 4: {0: 1365, 1: 1413, 2: 1369, 3: 1425, 4: 1393, 5: 1426, 6: 1384, 7: 1374, 8: 1445, 9: 1326}}
07-20 20:29 INFO     Getting global dataset using get_dataloader.
07-20 20:29 INFO     Initializing nets
07-20 20:29 INFO     in comm round:0
07-20 20:29 INFO     Training network 0. n_training: 19608
07-20 20:29 INFO     Training network 0
07-20 20:30 INFO     >> Pre-Training Training accuracy: 0.0
07-20 20:30 INFO     >> Pre-Training Test accuracy: 0.0
07-20 20:30 INFO     Epoch: 0 Total: 1.9547 CE: 1.8538 Topo: 2.0184
07-20 20:31 INFO     Epoch: 1 Total: 1.4717 CE: 1.3896 Topo: 1.6413
07-20 20:32 INFO     Epoch: 2 Total: 1.2251 CE: 1.1443 Topo: 1.6161
07-20 20:32 INFO     Epoch: 3 Total: 1.0631 CE: 0.9788 Topo: 1.6859
07-20 20:33 INFO     Epoch: 4 Total: 0.9222 CE: 0.8421 Topo: 1.6015
07-20 20:33 INFO     >> Training accuracy: 0.710730
07-20 20:33 INFO     >> Test accuracy: 0.712200
07-20 20:33 INFO      ** Training complete **
07-20 20:33 INFO     >> Last-batch PI Similarity: 0.9897
07-20 20:33 INFO     >> Last-batch Topo Distance: 1.6478
07-20 20:33 INFO     >> Last-batch 1-CKA: 0.6555
07-20 20:33 INFO     >> Last-batch Entropy: 0.756077
07-20 20:33 INFO     >> Last-batch SWD: 0.2059
07-20 20:33 INFO     net 0 final test acc 0.712200
07-20 20:33 INFO     Training network 1. n_training: 123
07-20 20:33 INFO     Training network 1
07-20 20:33 INFO     >> Pre-Training Training accuracy: 0.0
07-20 20:33 INFO     >> Pre-Training Test accuracy: 0.0
07-20 20:34 INFO     Epoch: 0 Total: 6.2329 CE: 6.0770 Topo: 3.1178
07-20 20:34 INFO     Epoch: 1 Total: 3.3843 CE: 3.2408 Topo: 2.8710
07-20 20:34 INFO     Epoch: 2 Total: 2.5475 CE: 2.3981 Topo: 2.9872
07-20 20:34 INFO     Epoch: 3 Total: 2.3028 CE: 2.1565 Topo: 2.9261
07-20 20:34 INFO     Epoch: 4 Total: 2.1281 CE: 1.9691 Topo: 3.1797
07-20 20:34 INFO     >> Training accuracy: 0.227642
07-20 20:34 INFO     >> Test accuracy: 0.171600
07-20 20:34 INFO      ** Training complete **
07-20 20:34 INFO     >> Last-batch PI Similarity: 0.9905
07-20 20:34 INFO     >> Last-batch Topo Distance: 3.5741
07-20 20:34 INFO     >> Last-batch 1-CKA: 0.5632
07-20 20:34 INFO     >> Last-batch Entropy: 1.817565
07-20 20:34 INFO     >> Last-batch SWD: 0.5735
07-20 20:34 INFO     net 1 final test acc 0.171600
07-20 20:34 INFO     Training network 2. n_training: 878
07-20 20:34 INFO     Training network 2
07-20 20:34 INFO     >> Pre-Training Training accuracy: 0.0
07-20 20:34 INFO     >> Pre-Training Test accuracy: 0.0
07-20 20:34 INFO     Epoch: 0 Total: 3.3666 CE: 3.2249 Topo: 2.8347
07-20 20:34 INFO     Epoch: 1 Total: 2.3355 CE: 2.2160 Topo: 2.3911
07-20 20:34 INFO     Epoch: 2 Total: 2.1866 CE: 2.0846 Topo: 2.0390
07-20 20:34 INFO     Epoch: 3 Total: 2.1640 CE: 2.0434 Topo: 2.4129
07-20 20:34 INFO     Epoch: 4 Total: 1.9840 CE: 1.8612 Topo: 2.4558
07-20 20:34 INFO     >> Training accuracy: 0.338269
07-20 20:34 INFO     >> Test accuracy: 0.326700
07-20 20:34 INFO      ** Training complete **
07-20 20:34 INFO     >> Last-batch PI Similarity: 0.9917
07-20 20:34 INFO     >> Last-batch Topo Distance: 3.7222
07-20 20:34 INFO     >> Last-batch 1-CKA: 0.6175
07-20 20:34 INFO     >> Last-batch Entropy: 1.555285
07-20 20:34 INFO     >> Last-batch SWD: 0.5200
07-20 20:34 INFO     net 2 final test acc 0.326700
07-20 20:34 INFO     Training network 3. n_training: 15471
07-20 20:34 INFO     Training network 3
07-20 20:34 INFO     >> Pre-Training Training accuracy: 0.0
07-20 20:34 INFO     >> Pre-Training Test accuracy: 0.0
07-20 20:35 INFO     Epoch: 0 Total: 2.0329 CE: 1.9228 Topo: 2.2021
07-20 20:36 INFO     Epoch: 1 Total: 1.5991 CE: 1.5060 Topo: 1.8622
07-20 20:37 INFO     Epoch: 2 Total: 1.3717 CE: 1.2781 Topo: 1.8706
07-20 20:38 INFO     Epoch: 3 Total: 1.1891 CE: 1.1039 Topo: 1.7041
07-20 20:40 INFO     Epoch: 4 Total: 1.0470 CE: 0.9672 Topo: 1.5944
07-20 20:40 INFO     >> Training accuracy: 0.701894
07-20 20:40 INFO     >> Test accuracy: 0.704500
07-20 20:40 INFO      ** Training complete **
07-20 20:40 INFO     >> Last-batch PI Similarity: 0.9906
07-20 20:40 INFO     >> Last-batch Topo Distance: 2.2595
07-20 20:40 INFO     >> Last-batch 1-CKA: 0.6273
07-20 20:40 INFO     >> Last-batch Entropy: 0.819103
07-20 20:40 INFO     >> Last-batch SWD: 0.2644
07-20 20:40 INFO     net 3 final test acc 0.704500
07-20 20:40 INFO     Training network 4. n_training: 13920
07-20 20:40 INFO     Training network 4
07-20 20:40 INFO     >> Pre-Training Training accuracy: 0.0
07-20 20:40 INFO     >> Pre-Training Test accuracy: 0.0
07-20 20:41 INFO     Epoch: 0 Total: 2.0652 CE: 1.9520 Topo: 2.2635
07-20 20:42 INFO     Epoch: 1 Total: 1.6247 CE: 1.5359 Topo: 1.7768
07-20 20:42 INFO     Epoch: 2 Total: 1.3864 CE: 1.3137 Topo: 1.4536
07-20 20:43 INFO     Epoch: 3 Total: 1.2178 CE: 1.1498 Topo: 1.3597
07-20 20:43 INFO     Epoch: 4 Total: 1.0806 CE: 1.0129 Topo: 1.3537
07-20 20:43 INFO     >> Training accuracy: 0.647198
07-20 20:43 INFO     >> Test accuracy: 0.648700
07-20 20:43 INFO      ** Training complete **
07-20 20:43 INFO     >> Last-batch PI Similarity: 0.9899
07-20 20:43 INFO     >> Last-batch Topo Distance: 1.2401
07-20 20:43 INFO     >> Last-batch 1-CKA: 0.6247
07-20 20:43 INFO     >> Last-batch Entropy: 1.046063
07-20 20:43 INFO     >> Last-batch SWD: 0.1665
07-20 20:43 INFO     net 4 final test acc 0.648700
07-20 20:43 INFO     global n_training: 1563
07-20 20:43 INFO     global n_test: 313
07-20 20:44 INFO     >> Global Model Train accuracy: 0.100000
07-20 20:44 INFO     >> Global Model Test accuracy: 0.100000
07-20 20:44 INFO     >> Global Model Entropy: 6.856389
07-20 20:44 INFO     in comm round:1
07-20 20:44 INFO     Training network 0. n_training: 19608
07-20 20:44 INFO     Training network 0
07-20 20:45 INFO     >> Pre-Training Training accuracy: 0.10026519787841698
07-20 20:45 INFO     >> Pre-Training Test accuracy: 0.1
07-20 20:45 INFO     Epoch: 0 Total: 1.5232 CE: 1.4563 Topo: 1.1155
07-20 20:46 INFO     Epoch: 1 Total: 1.1284 CE: 1.0636 Topo: 1.0803
07-20 20:47 INFO     Epoch: 2 Total: 1.0077 CE: 0.9367 Topo: 1.1840
07-20 20:48 INFO     Epoch: 3 Total: 0.9268 CE: 0.8528 Topo: 1.2341
07-20 20:48 INFO     Epoch: 4 Total: 0.8519 CE: 0.7732 Topo: 1.3106
07-20 20:48 INFO     >> Training accuracy: 0.727458
07-20 20:48 INFO     >> Test accuracy: 0.717100
07-20 20:48 INFO      ** Training complete **
07-20 20:48 INFO     >> Last-batch PI Similarity: 0.9965
07-20 20:48 INFO     >> Last-batch Topo Distance: 1.5314
07-20 20:48 INFO     >> Last-batch 1-CKA: 0.6518
07-20 20:48 INFO     >> Last-batch Entropy: 0.915739
07-20 20:48 INFO     >> Last-batch SWD: 0.1762
07-20 20:48 INFO     net 0 final test acc 0.717100
07-20 20:48 INFO     Training network 1. n_training: 123
07-20 20:48 INFO     Training network 1
07-20 20:49 INFO     >> Pre-Training Training accuracy: 0.11382113821138211
07-20 20:49 INFO     >> Pre-Training Test accuracy: 0.1
07-20 20:49 INFO     Epoch: 0 Total: 2.8536 CE: 2.7859 Topo: 1.1277
07-20 20:49 INFO     Epoch: 1 Total: 2.5224 CE: 2.3816 Topo: 2.3468
07-20 20:49 INFO     Epoch: 2 Total: 2.3443 CE: 2.2251 Topo: 1.9865
07-20 20:49 INFO     Epoch: 3 Total: 2.0439 CE: 1.9451 Topo: 1.6473
07-20 20:49 INFO     Epoch: 4 Total: 1.8585 CE: 1.7689 Topo: 1.4929
07-20 20:49 INFO     >> Training accuracy: 0.398374
07-20 20:49 INFO     >> Test accuracy: 0.380600
07-20 20:49 INFO      ** Training complete **
07-20 20:49 INFO     >> Last-batch PI Similarity: 0.9971
07-20 20:49 INFO     >> Last-batch Topo Distance: 1.4826
07-20 20:49 INFO     >> Last-batch 1-CKA: 0.6650
07-20 20:49 INFO     >> Last-batch Entropy: 1.769888
07-20 20:49 INFO     >> Last-batch SWD: 0.2483
07-20 20:49 INFO     net 1 final test acc 0.380600
07-20 20:49 INFO     Training network 2. n_training: 878
07-20 20:49 INFO     Training network 2
