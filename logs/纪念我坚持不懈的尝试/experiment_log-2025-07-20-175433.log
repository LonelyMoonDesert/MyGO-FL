07-20 17:54 INFO     Namespace(model='resnet18', resume=True, ckpt_dir='./checkpoints', dataset='cifar10', net_config=None, partition='iid-diff-quantity', batch_size=32, lr=0.01, lr_G=0.008, lr_D=0.008, epochs=5, epoch_G=5, epoch_D=1, n_parties=5, alg='fedtopo', training_type='local', use_projection_head=False, out_dim=256, loss='contrastive', temperature=0.5, comm_round=10, is_same_initial=1, init_seed=0, dropout_p=0.0, datadir='../data/', reg=1e-05, l1_lambda=0.0001, l1=False, adv_l1_lambda=0.0001, adv_l1=False, lambda_adv=0.3, logdir='./logs/', modeldir='./models/', beta=0.5, device='cuda:0', log_file_name='experiment_log-2025-07-20-175433', optimizer='sgd', optimizer_G='sgd', optimizer_D='sgd', mu=0.01, noise=0.0, noise_type='level', rho=0.9, sample=1.0, scheduler='StepLR', scheduler_g='StepLR', scheduler_d='StepLR', gamma=0.01, step_size=30, milestones='30,60', T_max=50, factor=0.1, patience=10, base_lr=0.001, max_lr=0.01, step_size_up=2000, steps_per_epoch=1000, feature_layer='conv1', max_samples=1000, umap_dim=3, n_umap_batches=4)
07-20 17:54 INFO     cuda:0
07-20 17:54 INFO     ####################################################################################################
07-20 17:54 INFO     Partitioning data
07-20 17:54 INFO     Data statistics: {0: {0: 1954, 1: 1966, 2: 1962, 3: 1953, 4: 1966, 5: 1941, 6: 1921, 7: 1967, 8: 1952, 9: 2026}, 1: {0: 17, 1: 17, 2: 8, 3: 18, 4: 14, 5: 13, 6: 11, 7: 9, 8: 8, 9: 8}, 2: {0: 94, 1: 99, 2: 96, 3: 81, 4: 83, 5: 76, 6: 79, 7: 86, 8: 81, 9: 103}, 3: {0: 1570, 1: 1505, 2: 1565, 3: 1523, 4: 1544, 5: 1544, 6: 1605, 7: 1564, 8: 1514, 9: 1537}, 4: {0: 1365, 1: 1413, 2: 1369, 3: 1425, 4: 1393, 5: 1426, 6: 1384, 7: 1374, 8: 1445, 9: 1326}}
07-20 17:54 INFO     Getting global dataset using get_dataloader.
07-20 17:54 INFO     Initializing nets
07-20 17:55 INFO     in comm round:0
07-20 17:55 INFO     Training network 0. n_training: 19608
07-20 17:56 INFO     Training network 0
07-20 17:56 INFO     >> Pre-Training Training accuracy: 0.0
07-20 17:56 INFO     >> Pre-Training Test accuracy: 0.0
07-20 17:57 INFO     Epoch: 0 Total: 1.9205 CE: 1.8658 Topo: 1.0930
07-20 17:58 INFO     Epoch: 1 Total: 1.4874 CE: 1.4007 Topo: 1.7341
07-20 17:58 INFO     Epoch: 2 Total: 1.2458 CE: 1.1576 Topo: 1.7636
07-20 17:59 INFO     Epoch: 3 Total: 1.0979 CE: 0.9886 Topo: 2.1867
07-20 18:00 INFO     Epoch: 4 Total: 0.9589 CE: 0.8556 Topo: 2.0669
07-20 18:00 INFO     >> Training accuracy: 0.728580
07-20 18:00 INFO     >> Test accuracy: 0.729500
07-20 18:00 INFO      ** Training complete **
07-20 18:00 INFO     >> Last-batch PI Similarity: 0.9997
07-20 18:00 INFO     >> Last-batch Topo Distance: 2.2869
07-20 18:00 INFO     >> Last-batch 1-CKA: 0.9482
07-20 18:00 INFO     >> Last-batch Entropy: 0.790629
07-20 18:00 INFO     >> Last-batch SWD: 0.3680
07-20 18:00 INFO     net 0 final test acc 0.729500
07-20 18:00 INFO     Training network 1. n_training: 123
07-20 18:00 INFO     Training network 1
07-20 18:00 INFO     >> Pre-Training Training accuracy: 0.0
07-20 18:00 INFO     >> Pre-Training Test accuracy: 0.0
07-20 18:00 INFO     Epoch: 0 Total: 6.0834 CE: 6.0773 Topo: 0.1227
07-20 18:00 INFO     Epoch: 1 Total: 3.2499 CE: 3.2298 Topo: 0.4035
07-20 18:00 INFO     Epoch: 2 Total: 2.4406 CE: 2.4120 Topo: 0.5719
07-20 18:00 INFO     Epoch: 3 Total: 2.2000 CE: 2.1684 Topo: 0.6328
07-20 18:00 INFO     Epoch: 4 Total: 2.0382 CE: 2.0039 Topo: 0.6856
07-20 18:00 INFO     >> Training accuracy: 0.154472
07-20 18:00 INFO     >> Test accuracy: 0.126000
07-20 18:00 INFO      ** Training complete **
07-20 18:00 INFO     >> Last-batch PI Similarity: 0.9999
07-20 18:00 INFO     >> Last-batch Topo Distance: 0.5995
07-20 18:00 INFO     >> Last-batch 1-CKA: 0.5117
07-20 18:00 INFO     >> Last-batch Entropy: 1.844739
07-20 18:00 INFO     >> Last-batch SWD: 0.0676
07-20 18:00 INFO     net 1 final test acc 0.126000
07-20 18:00 INFO     Training network 2. n_training: 878
07-20 18:00 INFO     Training network 2
07-20 18:00 INFO     >> Pre-Training Training accuracy: 0.0
07-20 18:00 INFO     >> Pre-Training Test accuracy: 0.0
07-20 18:00 INFO     Epoch: 0 Total: 3.2222 CE: 3.2053 Topo: 0.3370
07-20 18:00 INFO     Epoch: 1 Total: 2.2364 CE: 2.2112 Topo: 0.5027
07-20 18:00 INFO     Epoch: 2 Total: 2.1382 CE: 2.1047 Topo: 0.6694
07-20 18:00 INFO     Epoch: 3 Total: 2.0794 CE: 2.0462 Topo: 0.6650
07-20 18:01 INFO     Epoch: 4 Total: 1.9273 CE: 1.8976 Topo: 0.5954
07-20 18:01 INFO     >> Training accuracy: 0.354214
07-20 18:01 INFO     >> Test accuracy: 0.334300
07-20 18:01 INFO      ** Training complete **
07-20 18:01 INFO     >> Last-batch PI Similarity: 0.9996
07-20 18:01 INFO     >> Last-batch Topo Distance: 0.7227
07-20 18:01 INFO     >> Last-batch 1-CKA: 0.7500
07-20 18:01 INFO     >> Last-batch Entropy: 1.534856
07-20 18:01 INFO     >> Last-batch SWD: 0.0667
07-20 18:01 INFO     net 2 final test acc 0.334300
07-20 18:01 INFO     Training network 3. n_training: 15471
07-20 18:01 INFO     Training network 3
07-20 18:01 INFO     >> Pre-Training Training accuracy: 0.0
07-20 18:01 INFO     >> Pre-Training Test accuracy: 0.0
07-20 18:02 INFO     Epoch: 0 Total: 1.9856 CE: 1.9289 Topo: 1.1348
07-20 18:02 INFO     Epoch: 1 Total: 1.6147 CE: 1.5098 Topo: 2.0973
07-20 18:03 INFO     Epoch: 2 Total: 1.4218 CE: 1.2977 Topo: 2.4829
07-20 18:04 INFO     Epoch: 3 Total: 1.2513 CE: 1.1183 Topo: 2.6602
07-20 18:05 INFO     Epoch: 4 Total: 1.0991 CE: 0.9812 Topo: 2.3584
07-20 18:05 INFO     >> Training accuracy: 0.688449
07-20 18:05 INFO     >> Test accuracy: 0.684200
07-20 18:05 INFO      ** Training complete **
07-20 18:05 INFO     >> Last-batch PI Similarity: 0.9989
07-20 18:05 INFO     >> Last-batch Topo Distance: 4.5610
07-20 18:05 INFO     >> Last-batch 1-CKA: 0.9871
07-20 18:05 INFO     >> Last-batch Entropy: 0.934313
07-20 18:05 INFO     >> Last-batch SWD: 0.6197
07-20 18:05 INFO     net 3 final test acc 0.684200
07-20 18:05 INFO     Training network 4. n_training: 13920
07-20 18:05 INFO     Training network 4
07-20 18:05 INFO     >> Pre-Training Training accuracy: 0.0
07-20 18:05 INFO     >> Pre-Training Test accuracy: 0.0
07-20 18:05 INFO     Epoch: 0 Total: 1.9902 CE: 1.9425 Topo: 0.9546
07-20 18:06 INFO     Epoch: 1 Total: 1.5892 CE: 1.5281 Topo: 1.2221
07-20 18:06 INFO     Epoch: 2 Total: 1.3636 CE: 1.2996 Topo: 1.2797
07-20 18:07 INFO     Epoch: 3 Total: 1.1995 CE: 1.1423 Topo: 1.1455
07-20 18:07 INFO     Epoch: 4 Total: 1.0707 CE: 1.0134 Topo: 1.1459
07-20 18:08 INFO     >> Training accuracy: 0.685704
07-20 18:08 INFO     >> Test accuracy: 0.682500
07-20 18:08 INFO      ** Training complete **
07-20 18:08 INFO     >> Last-batch PI Similarity: 0.9999
07-20 18:08 INFO     >> Last-batch Topo Distance: 1.1330
07-20 18:08 INFO     >> Last-batch 1-CKA: 0.8753
07-20 18:08 INFO     >> Last-batch Entropy: 1.000162
07-20 18:08 INFO     >> Last-batch SWD: 0.1335
07-20 18:08 INFO     net 4 final test acc 0.682500
07-20 18:08 INFO     global n_training: 1563
07-20 18:08 INFO     global n_test: 313
07-20 18:08 INFO     >> Global Model Train accuracy: 0.100040
07-20 18:08 INFO     >> Global Model Test accuracy: 0.100000
07-20 18:09 INFO     >> Global Model Entropy: 6.857189
07-20 18:09 INFO     in comm round:1
07-20 18:09 INFO     Training network 0. n_training: 19608
07-20 18:09 INFO     Training network 0
07-20 18:09 INFO     >> Pre-Training Training accuracy: 0.10031619747042024
07-20 18:09 INFO     >> Pre-Training Test accuracy: 0.1
07-20 18:10 INFO     Epoch: 0 Total: 1.5721 CE: 1.5266 Topo: 0.7593
07-20 18:10 INFO     Epoch: 1 Total: 1.1508 CE: 1.1049 Topo: 0.7655
07-20 18:11 INFO     Epoch: 2 Total: 1.0008 CE: 0.9627 Topo: 0.6350
07-20 18:12 INFO     Epoch: 3 Total: 0.9025 CE: 0.8647 Topo: 0.6313
07-20 18:13 INFO     Epoch: 4 Total: 0.8285 CE: 0.7887 Topo: 0.6649
07-20 18:13 INFO     >> Training accuracy: 0.729498
07-20 18:13 INFO     >> Test accuracy: 0.711600
07-20 18:13 INFO      ** Training complete **
07-20 18:13 INFO     >> Last-batch PI Similarity: 1.0000
07-20 18:13 INFO     >> Last-batch Topo Distance: 0.6772
07-20 18:13 INFO     >> Last-batch 1-CKA: 0.3693
07-20 18:13 INFO     >> Last-batch Entropy: 0.810666
07-20 18:13 INFO     >> Last-batch SWD: 0.1108
07-20 18:13 INFO     net 0 final test acc 0.711600
07-20 18:13 INFO     Training network 1. n_training: 123
07-20 18:13 INFO     Training network 1
07-20 18:13 INFO     >> Pre-Training Training accuracy: 0.11382113821138211
07-20 18:13 INFO     >> Pre-Training Test accuracy: 0.1
07-20 18:13 INFO     Epoch: 0 Total: 2.8484 CE: 2.8404 Topo: 0.1328
07-20 18:13 INFO     Epoch: 1 Total: 2.5729 CE: 2.5472 Topo: 0.4295
07-20 18:13 INFO     Epoch: 2 Total: 2.3891 CE: 2.3400 Topo: 0.8182
07-20 18:13 INFO     Epoch: 3 Total: 2.1141 CE: 2.0444 Topo: 1.1607
07-20 18:13 INFO     Epoch: 4 Total: 1.8962 CE: 1.8225 Topo: 1.2299
07-20 18:13 INFO     >> Training accuracy: 0.430894
07-20 18:13 INFO     >> Test accuracy: 0.310200
07-20 18:13 INFO      ** Training complete **
07-20 18:13 INFO     >> Last-batch PI Similarity: 0.9997
07-20 18:13 INFO     >> Last-batch Topo Distance: 1.3556
07-20 18:13 INFO     >> Last-batch 1-CKA: 0.3102
07-20 18:13 INFO     >> Last-batch Entropy: 2.036992
07-20 18:13 INFO     >> Last-batch SWD: 0.2078
07-20 18:13 INFO     net 1 final test acc 0.310200
07-20 18:13 INFO     Training network 2. n_training: 878
07-20 18:13 INFO     Training network 2
07-20 18:13 INFO     >> Pre-Training Training accuracy: 0.09453302961275627
07-20 18:13 INFO     >> Pre-Training Test accuracy: 0.1
07-20 18:13 INFO     Epoch: 0 Total: 2.4497 CE: 2.4129 Topo: 0.6141
07-20 18:13 INFO     Epoch: 1 Total: 1.9369 CE: 1.9100 Topo: 0.4481
07-20 18:13 INFO     Epoch: 2 Total: 1.7870 CE: 1.7516 Topo: 0.5892
07-20 18:13 INFO     Epoch: 3 Total: 1.7169 CE: 1.6866 Topo: 0.5057
07-20 18:13 INFO     Epoch: 4 Total: 1.6703 CE: 1.6207 Topo: 0.8253
07-20 18:13 INFO     >> Training accuracy: 0.445330
07-20 18:13 INFO     >> Test accuracy: 0.421900
07-20 18:13 INFO      ** Training complete **
07-20 18:13 INFO     >> Last-batch PI Similarity: 0.9998
07-20 18:13 INFO     >> Last-batch Topo Distance: 1.3721
07-20 18:13 INFO     >> Last-batch 1-CKA: 0.2783
07-20 18:13 INFO     >> Last-batch Entropy: 1.634581
07-20 18:13 INFO     >> Last-batch SWD: 0.1556
07-20 18:13 INFO     net 2 final test acc 0.421900
07-20 18:13 INFO     Training network 3. n_training: 15471
07-20 18:13 INFO     Training network 3
07-20 18:13 INFO     >> Pre-Training Training accuracy: 0.10005817335660268
07-20 18:13 INFO     >> Pre-Training Test accuracy: 0.1
07-20 18:14 INFO     Epoch: 0 Total: 1.6377 CE: 1.5954 Topo: 0.7055
07-20 18:15 INFO     Epoch: 1 Total: 1.2522 CE: 1.1954 Topo: 0.9467
07-20 18:15 INFO     Epoch: 2 Total: 1.0759 CE: 1.0254 Topo: 0.8415
07-20 18:16 INFO     Epoch: 3 Total: 0.9726 CE: 0.9226 Topo: 0.8336
07-20 18:16 INFO     Epoch: 4 Total: 0.9123 CE: 0.8621 Topo: 0.8364
07-20 18:16 INFO     >> Training accuracy: 0.690453
07-20 18:16 INFO     >> Test accuracy: 0.683800
07-20 18:16 INFO      ** Training complete **
07-20 18:16 INFO     >> Last-batch PI Similarity: 0.9997
07-20 18:16 INFO     >> Last-batch Topo Distance: 1.7161
07-20 18:16 INFO     >> Last-batch 1-CKA: 0.2419
07-20 18:16 INFO     >> Last-batch Entropy: 0.852946
07-20 18:16 INFO     >> Last-batch SWD: 0.2234
07-20 18:16 INFO     net 3 final test acc 0.683800
07-20 18:16 INFO     Training network 4. n_training: 13920
07-20 18:17 INFO     Training network 4
07-20 18:17 INFO     >> Pre-Training Training accuracy: 0.10014367816091954
07-20 18:17 INFO     >> Pre-Training Test accuracy: 0.1
07-20 18:17 INFO     Epoch: 0 Total: 1.6334 CE: 1.5930 Topo: 0.6743
07-20 18:18 INFO     Epoch: 1 Total: 1.2532 CE: 1.2120 Topo: 0.6856
