07-20 13:19 INFO     Namespace(model='resnet18', resume=True, ckpt_dir='./checkpoints', dataset='cifar10', net_config=None, partition='iid-diff-quantity', batch_size=32, lr=0.01, lr_G=0.008, lr_D=0.008, epochs=5, epoch_G=5, epoch_D=1, n_parties=5, alg='fedtopo', training_type='local', use_projection_head=False, out_dim=256, loss='contrastive', temperature=0.5, comm_round=10, is_same_initial=1, init_seed=0, dropout_p=0.0, datadir='../data/', reg=1e-05, l1_lambda=0.0001, l1=False, adv_l1_lambda=0.0001, adv_l1=False, lambda_adv=0.3, logdir='./logs/', modeldir='./models/', beta=0.5, device='cuda:0', log_file_name='experiment_log-2025-07-20-131909', optimizer='sgd', optimizer_G='sgd', optimizer_D='sgd', mu=0.01, noise=0, noise_type='level', rho=0.9, sample=1.0, scheduler='StepLR', scheduler_g='StepLR', scheduler_d='StepLR', gamma=0.01, step_size=30, milestones='30,60', T_max=50, factor=0.1, patience=10, base_lr=0.001, max_lr=0.01, step_size_up=2000, steps_per_epoch=1000, feature_layer='layer3', max_samples=1536, umap_dim=3, n_umap_batches=8)
07-20 13:19 INFO     cuda:0
07-20 13:19 INFO     layer3
07-20 13:19 INFO     ####################################################################################################
07-20 13:19 INFO     Partitioning data
07-20 13:19 INFO     Data statistics: {0: {0: 1954, 1: 1966, 2: 1962, 3: 1953, 4: 1966, 5: 1941, 6: 1921, 7: 1967, 8: 1952, 9: 2026}, 1: {0: 17, 1: 17, 2: 8, 3: 18, 4: 14, 5: 13, 6: 11, 7: 9, 8: 8, 9: 8}, 2: {0: 94, 1: 99, 2: 96, 3: 81, 4: 83, 5: 76, 6: 79, 7: 86, 8: 81, 9: 103}, 3: {0: 1570, 1: 1505, 2: 1565, 3: 1523, 4: 1544, 5: 1544, 6: 1605, 7: 1564, 8: 1514, 9: 1537}, 4: {0: 1365, 1: 1413, 2: 1369, 3: 1425, 4: 1393, 5: 1426, 6: 1384, 7: 1374, 8: 1445, 9: 1326}}
07-20 13:19 INFO     Getting global dataset using get_dataloader.
07-20 13:19 INFO     Initializing nets
07-20 13:19 INFO     in comm round:0
07-20 13:19 INFO     Training network 0. n_training: 19608
07-20 13:19 INFO     Training network 0
07-20 13:19 INFO     >> Pre-Training Training accuracy: 0.0
07-20 13:19 INFO     >> Pre-Training Test accuracy: 0.0
07-20 13:20 INFO     Epoch: 0 Total: 1.9502 CE: 1.8663 Topo: 1.6798 LR: 0.01
07-20 13:20 INFO     Epoch: 1 Total: 1.4645 CE: 1.3995 Topo: 1.2991 LR: 0.01
07-20 13:21 INFO     Epoch: 2 Total: 1.2185 CE: 1.1522 Topo: 1.3271 LR: 0.01
07-20 13:22 INFO     Epoch: 3 Total: 1.0380 CE: 0.9764 Topo: 1.2320 LR: 0.01
07-20 13:23 INFO     Epoch: 4 Total: 0.9295 CE: 0.8683 Topo: 1.2225 LR: 0.01
07-20 13:23 INFO     >> Training accuracy: 0.685129
07-20 13:23 INFO     >> Test accuracy: 0.679200
07-20 13:23 INFO      ** Training complete **
07-20 13:23 INFO     >> Last-batch PI Similarity: 0.9880
07-20 13:23 INFO     >> Last-batch Topo Distance: 1.1343
07-20 13:23 INFO     >> Last-batch 1-CKA: 0.6487
07-20 13:23 INFO     >> Last-batch Entropy: 1.067993
07-20 13:23 INFO     >> Last-batch SWD: 0.1521
07-20 13:23 INFO     net 0 final test acc 0.679200
07-20 13:23 INFO     Training network 1. n_training: 123
07-20 13:23 INFO     Training network 1
07-20 13:23 INFO     >> Pre-Training Training accuracy: 0.0
07-20 13:23 INFO     >> Pre-Training Test accuracy: 0.0
07-20 13:23 INFO     Epoch: 0 Total: 6.2899 CE: 6.1347 Topo: 3.1032 LR: 0.01
07-20 13:23 INFO     Epoch: 1 Total: 3.4172 CE: 3.2721 Topo: 2.9028 LR: 0.01
07-20 13:23 INFO     Epoch: 2 Total: 2.5558 CE: 2.4115 Topo: 2.8857 LR: 0.01
07-20 13:23 INFO     Epoch: 3 Total: 2.2066 CE: 2.0597 Topo: 2.9379 LR: 0.01
07-20 13:23 INFO     Epoch: 4 Total: 2.1089 CE: 1.9574 Topo: 3.0298 LR: 0.01
07-20 13:23 INFO     >> Training accuracy: 0.276423
07-20 13:23 INFO     >> Test accuracy: 0.167100
07-20 13:23 INFO      ** Training complete **
07-20 13:23 INFO     >> Last-batch PI Similarity: 0.9903
07-20 13:23 INFO     >> Last-batch Topo Distance: 3.2979
07-20 13:23 INFO     >> Last-batch 1-CKA: 0.5695
07-20 13:23 INFO     >> Last-batch Entropy: 1.746761
07-20 13:23 INFO     >> Last-batch SWD: 0.4445
07-20 13:23 INFO     net 1 final test acc 0.167100
07-20 13:23 INFO     Training network 2. n_training: 878
07-20 13:23 INFO     Training network 2
07-20 13:23 INFO     >> Pre-Training Training accuracy: 0.0
07-20 13:23 INFO     >> Pre-Training Test accuracy: 0.0
07-20 13:23 INFO     Epoch: 0 Total: 3.1692 CE: 3.0194 Topo: 2.9973 LR: 0.01
07-20 13:23 INFO     Epoch: 1 Total: 2.4074 CE: 2.2682 Topo: 2.7851 LR: 0.01
07-20 13:23 INFO     Epoch: 2 Total: 2.2962 CE: 2.1615 Topo: 2.6928 LR: 0.01
07-20 13:23 INFO     Epoch: 3 Total: 2.1349 CE: 2.0210 Topo: 2.2778 LR: 0.01
07-20 13:23 INFO     Epoch: 4 Total: 2.1824 CE: 2.0685 Topo: 2.2789 LR: 0.01
07-20 13:23 INFO     >> Training accuracy: 0.239180
07-20 13:23 INFO     >> Test accuracy: 0.214600
07-20 13:23 INFO      ** Training complete **
07-20 13:23 INFO     >> Last-batch PI Similarity: 0.9904
07-20 13:23 INFO     >> Last-batch Topo Distance: 2.9386
07-20 13:23 INFO     >> Last-batch 1-CKA: 0.6170
07-20 13:23 INFO     >> Last-batch Entropy: 1.327599
07-20 13:23 INFO     >> Last-batch SWD: 0.2456
07-20 13:23 INFO     net 2 final test acc 0.214600
07-20 13:23 INFO     Training network 3. n_training: 15471
07-20 13:23 INFO     Training network 3
07-20 13:23 INFO     >> Pre-Training Training accuracy: 0.0
07-20 13:23 INFO     >> Pre-Training Test accuracy: 0.0
07-20 13:24 INFO     Epoch: 0 Total: 2.0001 CE: 1.8982 Topo: 2.0370 LR: 0.01
07-20 13:24 INFO     Epoch: 1 Total: 1.5170 CE: 1.4448 Topo: 1.4451 LR: 0.01
07-20 13:25 INFO     Epoch: 2 Total: 1.2825 CE: 1.2183 Topo: 1.2833 LR: 0.01
07-20 13:26 INFO     Epoch: 3 Total: 1.1236 CE: 1.0622 Topo: 1.2288 LR: 0.01
07-20 13:26 INFO     Epoch: 4 Total: 1.0196 CE: 0.9578 Topo: 1.2374 LR: 0.01
07-20 13:26 INFO     >> Training accuracy: 0.696658
07-20 13:26 INFO     >> Test accuracy: 0.692200
07-20 13:26 INFO      ** Training complete **
07-20 13:26 INFO     >> Last-batch PI Similarity: 0.9882
07-20 13:26 INFO     >> Last-batch Topo Distance: 1.2654
07-20 13:26 INFO     >> Last-batch 1-CKA: 0.6673
07-20 13:26 INFO     >> Last-batch Entropy: 0.781631
07-20 13:26 INFO     >> Last-batch SWD: 0.1495
07-20 13:26 INFO     net 3 final test acc 0.692200
07-20 13:26 INFO     Training network 4. n_training: 13920
07-20 13:26 INFO     Training network 4
07-20 13:27 INFO     >> Pre-Training Training accuracy: 0.0
07-20 13:27 INFO     >> Pre-Training Test accuracy: 0.0
07-20 13:27 INFO     Epoch: 0 Total: 2.0597 CE: 1.9470 Topo: 2.2543 LR: 0.01
07-20 13:28 INFO     Epoch: 1 Total: 1.6089 CE: 1.5174 Topo: 1.8300 LR: 0.01
07-20 13:28 INFO     Epoch: 2 Total: 1.4086 CE: 1.3194 Topo: 1.7839 LR: 0.01
07-20 13:29 INFO     Epoch: 3 Total: 1.2570 CE: 1.1631 Topo: 1.8791 LR: 0.01
07-20 13:29 INFO     Epoch: 4 Total: 1.1256 CE: 1.0377 Topo: 1.7576 LR: 0.01
07-20 13:29 INFO     >> Training accuracy: 0.613649
07-20 13:29 INFO     >> Test accuracy: 0.619200
07-20 13:29 INFO      ** Training complete **
07-20 13:29 INFO     >> Last-batch PI Similarity: 0.9911
07-20 13:29 INFO     >> Last-batch Topo Distance: 1.5893
07-20 13:29 INFO     >> Last-batch 1-CKA: 0.6223
07-20 13:29 INFO     >> Last-batch Entropy: 0.699252
07-20 13:29 INFO     >> Last-batch SWD: 0.2592
07-20 13:29 INFO     net 4 final test acc 0.619200
07-20 13:29 INFO     global n_training: 1563
07-20 13:29 INFO     global n_test: 313
07-20 13:30 INFO     >> Global Model Train accuracy: 0.105040
07-20 13:30 INFO     >> Global Model Test accuracy: 0.107900
07-20 13:30 INFO     in comm round:1
07-20 13:30 INFO     Training network 0. n_training: 19608
07-20 13:30 INFO     Training network 0
07-20 13:31 INFO     >> Pre-Training Training accuracy: 0.1046001631986944
07-20 13:31 INFO     >> Pre-Training Test accuracy: 0.1079
