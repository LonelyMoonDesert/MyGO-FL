07-20 20:50 INFO     Namespace(model='resnet18', resume=True, ckpt_dir='./checkpoints', dataset='cifar10', net_config=None, partition='iid-diff-quantity', batch_size=32, lr=0.01, lr_G=0.008, lr_D=0.008, epochs=5, epoch_G=5, epoch_D=1, n_parties=5, alg='fedtopo', training_type='local', use_projection_head=False, out_dim=256, loss='contrastive', temperature=0.5, comm_round=10, is_same_initial=1, init_seed=0, dropout_p=0.0, datadir='../data/', reg=1e-05, l1_lambda=0.0001, l1=False, adv_l1_lambda=0.0001, adv_l1=False, lambda_adv=0.3, logdir='./logs/', modeldir='./models/', beta=0.5, device='cuda:0', log_file_name='experiment_log-2025-07-20-205040', optimizer='sgd', optimizer_G='sgd', optimizer_D='sgd', mu=0.01, noise=0.0, noise_type='level', rho=0.9, sample=1.0, scheduler='StepLR', scheduler_g='StepLR', scheduler_d='StepLR', gamma=0.01, step_size=30, milestones='30,60', T_max=50, factor=0.1, patience=10, base_lr=0.001, max_lr=0.01, step_size_up=2000, steps_per_epoch=1000, feature_layer='conv1', max_samples=1000, umap_dim=3, n_umap_batches=4)
07-20 20:50 INFO     cuda:0
07-20 20:50 INFO     ####################################################################################################
07-20 20:50 INFO     Partitioning data
07-20 20:50 INFO     Data statistics: {0: {0: 1954, 1: 1966, 2: 1962, 3: 1953, 4: 1966, 5: 1941, 6: 1921, 7: 1967, 8: 1952, 9: 2026}, 1: {0: 17, 1: 17, 2: 8, 3: 18, 4: 14, 5: 13, 6: 11, 7: 9, 8: 8, 9: 8}, 2: {0: 94, 1: 99, 2: 96, 3: 81, 4: 83, 5: 76, 6: 79, 7: 86, 8: 81, 9: 103}, 3: {0: 1570, 1: 1505, 2: 1565, 3: 1523, 4: 1544, 5: 1544, 6: 1605, 7: 1564, 8: 1514, 9: 1537}, 4: {0: 1365, 1: 1413, 2: 1369, 3: 1425, 4: 1393, 5: 1426, 6: 1384, 7: 1374, 8: 1445, 9: 1326}}
07-20 20:50 INFO     Getting global dataset using get_dataloader.
07-20 20:50 INFO     Initializing nets
07-20 20:51 INFO     in comm round:0
07-20 20:51 INFO     Training network 0. n_training: 19608
07-20 20:51 INFO     Training network 0
07-20 20:51 INFO     >> Pre-Training Training accuracy: 0.0
07-20 20:51 INFO     >> Pre-Training Test accuracy: 0.0
07-20 20:52 INFO     Epoch: 0 Total: 1.9423 CE: 1.8571 Topo: 1.7028
07-20 20:53 INFO     Epoch: 1 Total: 1.4433 CE: 1.3760 Topo: 1.3441
07-20 20:53 INFO     Epoch: 2 Total: 1.1830 CE: 1.1217 Topo: 1.2276
07-20 20:54 INFO     Epoch: 3 Total: 1.0287 CE: 0.9643 Topo: 1.2892
07-20 20:56 INFO     Epoch: 4 Total: 0.8936 CE: 0.8326 Topo: 1.2194
07-20 20:56 INFO     >> Training accuracy: 0.721287
07-20 20:56 INFO     >> Test accuracy: 0.718100
07-20 20:56 INFO      ** Training complete **
07-20 20:56 INFO     >> Last-batch PI Similarity: 0.9909
07-20 20:56 INFO     >> Last-batch Topo Distance: 1.3413
07-20 20:56 INFO     >> Last-batch 1-CKA: 0.6528
07-20 20:56 INFO     >> Last-batch Entropy: 0.697175
07-20 20:56 INFO     >> Last-batch SWD: 0.2132
07-20 20:56 INFO     net 0 final test acc 0.718100
07-20 20:56 INFO     Training network 1. n_training: 123
07-20 20:56 INFO     Training network 1
07-20 20:56 INFO     >> Pre-Training Training accuracy: 0.0
07-20 20:56 INFO     >> Pre-Training Test accuracy: 0.0
07-20 20:56 INFO     Epoch: 0 Total: 6.2323 CE: 6.0771 Topo: 3.1042
07-20 20:56 INFO     Epoch: 1 Total: 3.3814 CE: 3.2302 Topo: 3.0224
07-20 20:56 INFO     Epoch: 2 Total: 2.5641 CE: 2.4123 Topo: 3.0363
07-20 20:56 INFO     Epoch: 3 Total: 2.3003 CE: 2.1526 Topo: 2.9555
07-20 20:56 INFO     Epoch: 4 Total: 2.0632 CE: 1.9159 Topo: 2.9457
07-20 20:57 INFO     >> Training accuracy: 0.292683
07-20 20:57 INFO     >> Test accuracy: 0.194300
07-20 20:57 INFO      ** Training complete **
07-20 20:57 INFO     >> Last-batch PI Similarity: 0.9913
07-20 20:57 INFO     >> Last-batch Topo Distance: 3.5650
07-20 20:57 INFO     >> Last-batch 1-CKA: 0.5713
07-20 20:57 INFO     >> Last-batch Entropy: 1.767223
07-20 20:57 INFO     >> Last-batch SWD: 0.5373
07-20 20:57 INFO     net 1 final test acc 0.194300
07-20 20:57 INFO     Training network 2. n_training: 878
07-20 20:57 INFO     Training network 2
07-20 20:57 INFO     >> Pre-Training Training accuracy: 0.0
07-20 20:57 INFO     >> Pre-Training Test accuracy: 0.0
07-20 20:57 INFO     Epoch: 0 Total: 3.3590 CE: 3.2232 Topo: 2.7163
07-20 20:57 INFO     Epoch: 1 Total: 2.3290 CE: 2.2091 Topo: 2.3978
07-20 20:57 INFO     Epoch: 2 Total: 2.2162 CE: 2.1072 Topo: 2.1815
07-20 20:57 INFO     Epoch: 3 Total: 2.1242 CE: 2.0225 Topo: 2.0339
07-20 20:57 INFO     Epoch: 4 Total: 1.9677 CE: 1.8717 Topo: 1.9199
07-20 20:57 INFO     >> Training accuracy: 0.347380
07-20 20:57 INFO     >> Test accuracy: 0.313800
07-20 20:57 INFO      ** Training complete **
07-20 20:57 INFO     >> Last-batch PI Similarity: 0.9923
07-20 20:57 INFO     >> Last-batch Topo Distance: 2.5311
07-20 20:57 INFO     >> Last-batch 1-CKA: 0.6120
07-20 20:57 INFO     >> Last-batch Entropy: 1.419655
07-20 20:57 INFO     >> Last-batch SWD: 0.3781
07-20 20:57 INFO     net 2 final test acc 0.313800
07-20 20:57 INFO     Training network 3. n_training: 15471
07-20 20:57 INFO     Training network 3
07-20 20:58 INFO     >> Pre-Training Training accuracy: 0.0
07-20 20:58 INFO     >> Pre-Training Test accuracy: 0.0
07-20 20:59 INFO     Epoch: 0 Total: 2.0604 CE: 1.9328 Topo: 2.5525
07-20 21:00 INFO     Epoch: 1 Total: 1.6169 CE: 1.5043 Topo: 2.2509
07-20 21:01 INFO     Epoch: 2 Total: 1.3689 CE: 1.2721 Topo: 1.9376
07-20 21:02 INFO     Epoch: 3 Total: 1.1877 CE: 1.0960 Topo: 1.8341
07-20 21:03 INFO     Epoch: 4 Total: 1.0495 CE: 0.9664 Topo: 1.6631
07-20 21:03 INFO     >> Training accuracy: 0.687480
07-20 21:03 INFO     >> Test accuracy: 0.690800
07-20 21:03 INFO      ** Training complete **
07-20 21:03 INFO     >> Last-batch PI Similarity: 0.9914
07-20 21:03 INFO     >> Last-batch Topo Distance: 3.0040
07-20 21:03 INFO     >> Last-batch 1-CKA: 0.6483
07-20 21:03 INFO     >> Last-batch Entropy: 0.953697
07-20 21:03 INFO     >> Last-batch SWD: 0.3925
07-20 21:03 INFO     net 3 final test acc 0.690800
07-20 21:03 INFO     Training network 4. n_training: 13920
07-20 21:03 INFO     Training network 4
07-20 21:03 INFO     >> Pre-Training Training accuracy: 0.0
07-20 21:03 INFO     >> Pre-Training Test accuracy: 0.0
07-20 21:04 INFO     Epoch: 0 Total: 2.0586 CE: 1.9429 Topo: 2.3136
07-20 21:04 INFO     Epoch: 1 Total: 1.6410 CE: 1.5277 Topo: 2.2666
07-20 21:05 INFO     Epoch: 2 Total: 1.4074 CE: 1.3035 Topo: 2.0768
07-20 21:05 INFO     Epoch: 3 Total: 1.2426 CE: 1.1394 Topo: 2.0641
07-20 21:06 INFO     Epoch: 4 Total: 1.1082 CE: 1.0143 Topo: 1.8775
07-20 21:06 INFO     >> Training accuracy: 0.696264
07-20 21:06 INFO     >> Test accuracy: 0.695100
07-20 21:06 INFO      ** Training complete **
07-20 21:06 INFO     >> Last-batch PI Similarity: 0.9923
07-20 21:06 INFO     >> Last-batch Topo Distance: 2.0137
07-20 21:06 INFO     >> Last-batch 1-CKA: 0.6340
07-20 21:06 INFO     >> Last-batch Entropy: 0.981876
07-20 21:06 INFO     >> Last-batch SWD: 0.2792
07-20 21:06 INFO     net 4 final test acc 0.695100
07-20 21:06 INFO     global n_training: 1563
07-20 21:06 INFO     global n_test: 313
07-20 21:07 INFO     >> Global Model Train accuracy: 0.100020
07-20 21:07 INFO     >> Global Model Test accuracy: 0.100000
07-20 21:07 INFO     >> Global Model Entropy: 6.860115
07-20 21:07 INFO     in comm round:1
07-20 21:07 INFO     Training network 0. n_training: 19608
07-20 21:07 INFO     Training network 0
07-20 21:08 INFO     >> Pre-Training Training accuracy: 0.10026519787841698
07-20 21:08 INFO     >> Pre-Training Test accuracy: 0.1
07-20 21:09 INFO     Epoch: 0 Total: 1.6253 CE: 1.4748 Topo: 2.5078
07-20 21:11 INFO     Epoch: 1 Total: 1.2528 CE: 1.0725 Topo: 3.0062
07-20 21:12 INFO     Epoch: 2 Total: 1.1209 CE: 0.9329 Topo: 3.1321
07-20 21:15 INFO     Epoch: 3 Total: 1.0409 CE: 0.8379 Topo: 3.3822
07-20 21:17 INFO     Epoch: 4 Total: 0.9828 CE: 0.7749 Topo: 3.4643
07-20 21:17 INFO     >> Training accuracy: 0.723378
07-20 21:17 INFO     >> Test accuracy: 0.716900
07-20 21:17 INFO      ** Training complete **
07-20 21:17 INFO     >> Last-batch PI Similarity: 0.9950
07-20 21:17 INFO     >> Last-batch Topo Distance: 3.7670
07-20 21:17 INFO     >> Last-batch 1-CKA: 0.6385
07-20 21:17 INFO     >> Last-batch Entropy: 0.836382
07-20 21:17 INFO     >> Last-batch SWD: 0.7512
07-20 21:17 INFO     net 0 final test acc 0.716900
07-20 21:17 INFO     Training network 1. n_training: 123
07-20 21:17 INFO     Training network 1
07-20 21:17 INFO     >> Pre-Training Training accuracy: 0.11382113821138211
07-20 21:17 INFO     >> Pre-Training Test accuracy: 0.1
07-20 21:17 INFO     Epoch: 0 Total: 2.9310 CE: 2.8902 Topo: 0.6805
07-20 21:17 INFO     Epoch: 1 Total: 2.3426 CE: 2.2546 Topo: 1.4676
07-20 21:17 INFO     Epoch: 2 Total: 2.1955 CE: 2.0982 Topo: 1.6210
07-20 21:17 INFO     Epoch: 3 Total: 1.9757 CE: 1.8835 Topo: 1.5376
07-20 21:17 INFO     Epoch: 4 Total: 1.8821 CE: 1.7776 Topo: 1.7416
07-20 21:17 INFO     >> Training accuracy: 0.349593
07-20 21:17 INFO     >> Test accuracy: 0.332300
07-20 21:17 INFO      ** Training complete **
07-20 21:17 INFO     >> Last-batch PI Similarity: 0.9968
07-20 21:17 INFO     >> Last-batch Topo Distance: 2.0479
07-20 21:17 INFO     >> Last-batch 1-CKA: 0.6332
07-20 21:17 INFO     >> Last-batch Entropy: 1.741645
07-20 21:17 INFO     >> Last-batch SWD: 0.2629
07-20 21:17 INFO     net 1 final test acc 0.332300
07-20 21:17 INFO     Training network 2. n_training: 878
07-20 21:17 INFO     Training network 2
07-20 21:17 INFO     >> Pre-Training Training accuracy: 0.09453302961275627
07-20 21:17 INFO     >> Pre-Training Test accuracy: 0.1
07-20 21:17 INFO     Epoch: 0 Total: 2.2788 CE: 2.1950 Topo: 1.3971
07-20 21:17 INFO     Epoch: 1 Total: 1.9513 CE: 1.8502 Topo: 1.6838
07-20 21:17 INFO     Epoch: 2 Total: 1.9385 CE: 1.8141 Topo: 2.0742
07-20 21:17 INFO     Epoch: 3 Total: 1.8151 CE: 1.6922 Topo: 2.0478
07-20 21:18 INFO     Epoch: 4 Total: 1.7344 CE: 1.6113 Topo: 2.0521
07-20 21:18 INFO     >> Training accuracy: 0.490888
07-20 21:18 INFO     >> Test accuracy: 0.474600
07-20 21:18 INFO      ** Training complete **
07-20 21:18 INFO     >> Last-batch PI Similarity: 0.9971
07-20 21:18 INFO     >> Last-batch Topo Distance: 3.2952
07-20 21:18 INFO     >> Last-batch 1-CKA: 0.5991
07-20 21:18 INFO     >> Last-batch Entropy: 1.512811
07-20 21:18 INFO     >> Last-batch SWD: 0.3608
07-20 21:18 INFO     net 2 final test acc 0.474600
07-20 21:18 INFO     Training network 3. n_training: 15471
07-20 21:18 INFO     Training network 3
07-20 21:18 INFO     >> Pre-Training Training accuracy: 0.09979962510503523
07-20 21:18 INFO     >> Pre-Training Test accuracy: 0.1
07-20 21:18 INFO     Epoch: 0 Total: 1.6624 CE: 1.5321 Topo: 2.1730
07-20 21:19 INFO     Epoch: 1 Total: 1.3215 CE: 1.1540 Topo: 2.7922
07-20 21:20 INFO     Epoch: 2 Total: 1.1984 CE: 1.0112 Topo: 3.1202
