07-20 02:38 INFO     Namespace(model='resnet18', resume=True, ckpt_dir='./checkpoints', dataset='pacs', net_config=None, partition='domain', batch_size=32, lr=0.001, lr_G=0.008, lr_D=0.008, epochs=5, epoch_G=5, epoch_D=1, n_parties=3, alg='fedtopo', training_type='local', use_projection_head=False, out_dim=256, loss='contrastive', temperature=0.5, comm_round=10, is_same_initial=1, init_seed=0, dropout_p=0.0, datadir='../data/pacs', reg=1e-05, l1_lambda=0.0001, l1=False, adv_l1_lambda=0.0001, adv_l1=False, lambda_adv=0.3, logdir='./logs/', modeldir='./models/', beta=0.5, device='cuda:0', log_file_name='experiment_log-2025-07-20-023844', optimizer='sgd', optimizer_G='sgd', optimizer_D='sgd', mu=0.01, noise=0, noise_type='level', rho=0.9, sample=1.0, scheduler='ReduceLROnPlateau', scheduler_g='StepLR', scheduler_d='StepLR', gamma=0.01, step_size=30, milestones='30,60', T_max=50, factor=0.1, patience=10, base_lr=0.001, max_lr=0.01, step_size_up=2000, steps_per_epoch=1000, feature_layer='conv1', max_samples=1000, umap_dim=3, n_umap_batches=4)
07-20 02:38 INFO     cuda:0
07-20 02:38 INFO     layer3
07-20 02:38 INFO     ####################################################################################################
07-20 02:38 INFO     Partitioning data
07-20 02:38 INFO     Data statistics: {0: {0: 189, 1: 202, 2: 182, 3: 186, 4: 199, 5: 280, 6: 432}, 1: {0: 379, 1: 255, 2: 285, 3: 184, 4: 201, 5: 295, 6: 449}, 2: {0: 389, 1: 457, 2: 346, 3: 135, 4: 324, 5: 288, 6: 405}}
07-20 02:38 INFO     Getting global dataset using get_dataloader.
07-20 02:38 INFO     Initializing nets
07-20 02:38 INFO     in comm round:0
07-20 02:38 INFO     Training network 0. n_training: 1670
07-20 02:38 INFO     Training network 0
07-20 02:39 INFO     >> Pre-Training Training accuracy: 0.0
07-20 02:39 INFO     >> Pre-Training Test accuracy: 0.0005002501250625312
07-20 02:39 INFO     Epoch: 0 Total: 2.4541 CE: 2.4221 Topo: 0.6416 LR: 0.001
07-20 02:39 INFO     Epoch: 1 Total: 0.1385 CE: 0.1038 Topo: 0.6946 LR: 0.001
07-20 02:39 INFO     Epoch: 2 Total: 0.0917 CE: 0.0585 Topo: 0.6641 LR: 0.001
07-20 02:39 INFO     Epoch: 3 Total: 0.0625 CE: 0.0303 Topo: 0.6442 LR: 0.001
07-20 02:39 INFO     Epoch: 4 Total: 0.0676 CE: 0.0355 Topo: 0.6417 LR: 0.001
07-20 02:40 INFO     >> Training accuracy: 0.998802
07-20 02:40 INFO     >> Test accuracy: 0.454727
07-20 02:40 INFO      ** Training complete **
07-20 02:40 INFO     >> Last-batch PI Similarity: 1.0000
07-20 02:40 INFO     >> Last-batch Topo Distance: 2.0704
07-20 02:40 INFO     >> Last-batch 1-CKA: 0.1013
07-20 02:40 INFO     >> Last-batch Entropy: 0.162070
07-20 02:40 INFO     >> Last-batch SWD: 0.1048
07-20 02:40 INFO     net 0 final test acc 0.454727
07-20 02:40 INFO     Training network 1. n_training: 2048
07-20 02:40 INFO     Training network 1
07-20 02:40 INFO     >> Pre-Training Training accuracy: 0.0
07-20 02:40 INFO     >> Pre-Training Test accuracy: 0.0005002501250625312
07-20 02:40 INFO     Epoch: 0 Total: 2.6977 CE: 2.6636 Topo: 0.6815 LR: 0.001
07-20 02:40 INFO     Epoch: 1 Total: 0.3442 CE: 0.3102 Topo: 0.6800 LR: 0.001
07-20 02:41 INFO     Epoch: 2 Total: 0.1994 CE: 0.1654 Topo: 0.6796 LR: 0.001
07-20 02:41 INFO     Epoch: 3 Total: 0.1434 CE: 0.1087 Topo: 0.6933 LR: 0.001
07-20 02:41 INFO     Epoch: 4 Total: 0.1155 CE: 0.0808 Topo: 0.6931 LR: 0.001
07-20 02:41 INFO     >> Training accuracy: 0.992188
07-20 02:41 INFO     >> Test accuracy: 0.624812
07-20 02:41 INFO      ** Training complete **
07-20 02:41 INFO     >> Last-batch PI Similarity: 1.0000
07-20 02:41 INFO     >> Last-batch Topo Distance: 0.6600
07-20 02:41 INFO     >> Last-batch 1-CKA: 0.0883
07-20 02:41 INFO     >> Last-batch Entropy: 0.042062
07-20 02:41 INFO     >> Last-batch SWD: 0.0648
07-20 02:41 INFO     net 1 final test acc 0.624812
07-20 02:41 INFO     Training network 2. n_training: 2344
07-20 02:41 INFO     Training network 2
07-20 02:42 INFO     >> Pre-Training Training accuracy: 0.0
07-20 02:42 INFO     >> Pre-Training Test accuracy: 0.0005002501250625312
07-20 02:42 INFO     Epoch: 0 Total: 2.2069 CE: 2.1686 Topo: 0.7657 LR: 0.001
07-20 02:42 INFO     Epoch: 1 Total: 0.2961 CE: 0.2570 Topo: 0.7828 LR: 0.001
07-20 02:42 INFO     Epoch: 2 Total: 0.1889 CE: 0.1500 Topo: 0.7769 LR: 0.001
07-20 02:43 INFO     Epoch: 3 Total: 0.1295 CE: 0.0901 Topo: 0.7893 LR: 0.001
07-20 02:43 INFO     Epoch: 4 Total: 0.1119 CE: 0.0724 Topo: 0.7898 LR: 0.001
07-20 02:43 INFO     >> Training accuracy: 0.997440
07-20 02:43 INFO     >> Test accuracy: 0.682341
07-20 02:43 INFO      ** Training complete **
07-20 02:43 INFO     >> Last-batch PI Similarity: 0.9999
07-20 02:43 INFO     >> Last-batch Topo Distance: 1.6362
07-20 02:43 INFO     >> Last-batch 1-CKA: 0.2286
07-20 02:43 INFO     >> Last-batch Entropy: 0.054618
07-20 02:43 INFO     >> Last-batch SWD: 0.0791
07-20 02:43 INFO     net 2 final test acc 0.682341
07-20 02:43 INFO     global n_training: 250
07-20 02:43 INFO     global n_test: 63
07-20 02:44 INFO     >> Global Model Train accuracy: 0.693694
07-20 02:44 INFO     >> Global Model Test accuracy: 0.685843
07-20 02:44 INFO     in comm round:1
07-20 02:44 INFO     Training network 0. n_training: 1670
07-20 02:44 INFO     Training network 0
07-20 02:44 INFO     >> Pre-Training Training accuracy: 0.9287425149700599
07-20 02:44 INFO     >> Pre-Training Test accuracy: 0.6858429214607303
07-20 02:44 INFO     Epoch: 0 Total: 0.2359 CE: 0.1913 Topo: 0.7444 LR: 0.001
07-20 02:45 INFO     Epoch: 1 Total: 0.1454 CE: 0.0930 Topo: 0.8740 LR: 0.001
07-20 02:45 INFO     Epoch: 2 Total: 0.0976 CE: 0.0516 Topo: 0.7669 LR: 0.001
07-20 02:45 INFO     Epoch: 3 Total: 0.0789 CE: 0.0357 Topo: 0.7197 LR: 0.001
07-20 02:45 INFO     Epoch: 4 Total: 0.0563 CE: 0.0135 Topo: 0.7129 LR: 0.001
07-20 02:45 INFO     >> Training accuracy: 0.998802
07-20 02:45 INFO     >> Test accuracy: 0.548274
07-20 02:45 INFO      ** Training complete **
07-20 02:45 INFO     >> Last-batch PI Similarity: 0.9999
07-20 02:45 INFO     >> Last-batch Topo Distance: 1.2895
07-20 02:45 INFO     >> Last-batch 1-CKA: 0.1477
07-20 02:45 INFO     >> Last-batch Entropy: 0.010807
07-20 02:45 INFO     >> Last-batch SWD: 0.0635
07-20 02:45 INFO     net 0 final test acc 0.548274
07-20 02:45 INFO     Training network 1. n_training: 2048
07-20 02:45 INFO     Training network 1
07-20 02:46 INFO     >> Pre-Training Training accuracy: 0.81005859375
07-20 02:46 INFO     >> Pre-Training Test accuracy: 0.6858429214607303
