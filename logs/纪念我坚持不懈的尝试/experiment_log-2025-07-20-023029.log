07-20 02:30 INFO     Namespace(model='resnet18', resume=True, ckpt_dir='./checkpoints', dataset='pacs', net_config=None, partition='domain', batch_size=32, lr=0.002, lr_G=0.008, lr_D=0.008, epochs=5, epoch_G=5, epoch_D=1, n_parties=3, alg='fedtopo', training_type='local', use_projection_head=False, out_dim=256, loss='contrastive', temperature=0.5, comm_round=10, is_same_initial=1, init_seed=0, dropout_p=0.0, datadir='../data/pacs', reg=1e-05, l1_lambda=0.0001, l1=False, adv_l1_lambda=0.0001, adv_l1=False, lambda_adv=0.3, logdir='./logs/', modeldir='./models/', beta=0.5, device='cuda:0', log_file_name='experiment_log-2025-07-20-023029', optimizer='adam', optimizer_G='sgd', optimizer_D='sgd', mu=0.01, noise=0, noise_type='level', rho=0.9, sample=1.0, scheduler='ReduceLROnPlateau', scheduler_g='StepLR', scheduler_d='StepLR', gamma=0.01, step_size=30, milestones='30,60', T_max=50, factor=0.1, patience=10, base_lr=0.001, max_lr=0.01, step_size_up=2000, steps_per_epoch=1000, feature_layer='conv1', max_samples=1000, umap_dim=3, n_umap_batches=4)
07-20 02:30 INFO     cuda:0
07-20 02:30 INFO     layer3
07-20 02:30 INFO     ####################################################################################################
07-20 02:30 INFO     Partitioning data
07-20 02:30 INFO     Data statistics: {0: {0: 189, 1: 202, 2: 182, 3: 186, 4: 199, 5: 280, 6: 432}, 1: {0: 379, 1: 255, 2: 285, 3: 184, 4: 201, 5: 295, 6: 449}, 2: {0: 389, 1: 457, 2: 346, 3: 135, 4: 324, 5: 288, 6: 405}}
07-20 02:30 INFO     Getting global dataset using get_dataloader.
07-20 02:30 INFO     Initializing nets
07-20 02:30 INFO     in comm round:0
07-20 02:30 INFO     Training network 0. n_training: 1670
07-20 02:30 INFO     Training network 0
07-20 02:31 INFO     >> Pre-Training Training accuracy: 0.0
07-20 02:31 INFO     >> Pre-Training Test accuracy: 0.0005002501250625312
07-20 02:31 INFO     Epoch: 0 Total: 1.5293 CE: 1.4675 Topo: 1.2362 LR: 0.002
07-20 02:31 INFO     Epoch: 1 Total: 0.8178 CE: 0.7517 Topo: 1.3229 LR: 0.002
07-20 02:31 INFO     Epoch: 2 Total: 0.6876 CE: 0.6198 Topo: 1.3568 LR: 0.002
07-20 02:31 INFO     Epoch: 3 Total: 0.6993 CE: 0.6322 Topo: 1.3427 LR: 0.002
07-20 02:32 INFO     Epoch: 4 Total: 0.5782 CE: 0.5082 Topo: 1.4008 LR: 0.002
07-20 02:32 INFO     >> Training accuracy: 0.845509
07-20 02:32 INFO     >> Test accuracy: 0.279640
07-20 02:32 INFO      ** Training complete **
07-20 02:32 INFO     >> Last-batch PI Similarity: 0.9998
07-20 02:32 INFO     >> Last-batch Topo Distance: 2.3486
07-20 02:32 INFO     >> Last-batch 1-CKA: 0.4440
07-20 02:32 INFO     >> Last-batch Entropy: 0.518786
07-20 02:32 INFO     >> Last-batch SWD: 0.1882
07-20 02:32 INFO     net 0 final test acc 0.279640
07-20 02:32 INFO     Training network 1. n_training: 2048
07-20 02:32 INFO     Training network 1
07-20 02:32 INFO     >> Pre-Training Training accuracy: 0.0
07-20 02:32 INFO     >> Pre-Training Test accuracy: 0.0005002501250625312
07-20 02:32 INFO     Epoch: 0 Total: 2.0946 CE: 2.0109 Topo: 1.6744 LR: 0.002
07-20 02:33 INFO     Epoch: 1 Total: 1.1998 CE: 1.1111 Topo: 1.7739 LR: 0.002
07-20 02:33 INFO     Epoch: 2 Total: 1.0300 CE: 0.9472 Topo: 1.6564 LR: 0.002
07-20 02:33 INFO     Epoch: 3 Total: 0.8607 CE: 0.7815 Topo: 1.5849 LR: 0.002
07-20 02:33 INFO     Epoch: 4 Total: 0.7484 CE: 0.6708 Topo: 1.5537 LR: 0.002
07-20 02:33 INFO     >> Training accuracy: 0.780762
07-20 02:33 INFO     >> Test accuracy: 0.477239
07-20 02:33 INFO      ** Training complete **
07-20 02:33 INFO     >> Last-batch PI Similarity: 0.9997
07-20 02:33 INFO     >> Last-batch Topo Distance: 1.3782
07-20 02:33 INFO     >> Last-batch 1-CKA: 0.2583
07-20 02:33 INFO     >> Last-batch Entropy: 0.738182
07-20 02:33 INFO     >> Last-batch SWD: 0.2439
07-20 02:33 INFO     net 1 final test acc 0.477239
07-20 02:33 INFO     Training network 2. n_training: 2344
07-20 02:33 INFO     Training network 2
07-20 02:34 INFO     >> Pre-Training Training accuracy: 0.0
07-20 02:34 INFO     >> Pre-Training Test accuracy: 0.0005002501250625312
07-20 02:34 INFO     Epoch: 0 Total: 1.4501 CE: 1.3817 Topo: 1.3674 LR: 0.002
07-20 02:35 INFO     Epoch: 1 Total: 0.7359 CE: 0.6699 Topo: 1.3195 LR: 0.002
07-20 02:35 INFO     Epoch: 2 Total: 0.5898 CE: 0.5278 Topo: 1.2403 LR: 0.002
07-20 02:35 INFO     Epoch: 3 Total: 0.4817 CE: 0.4247 Topo: 1.1389 LR: 0.002
07-20 02:35 INFO     Epoch: 4 Total: 0.5509 CE: 0.5002 Topo: 1.0149 LR: 0.002
07-20 02:36 INFO     >> Training accuracy: 0.852816
07-20 02:36 INFO     >> Test accuracy: 0.483242
07-20 02:36 INFO      ** Training complete **
07-20 02:36 INFO     >> Last-batch PI Similarity: 0.9996
07-20 02:36 INFO     >> Last-batch Topo Distance: 2.1853
07-20 02:36 INFO     >> Last-batch 1-CKA: 0.4317
07-20 02:36 INFO     >> Last-batch Entropy: 0.378386
07-20 02:36 INFO     >> Last-batch SWD: 0.1120
07-20 02:36 INFO     net 2 final test acc 0.483242
07-20 02:36 INFO     global n_training: 250
07-20 02:36 INFO     global n_test: 63
07-20 02:37 INFO     >> Global Model Train accuracy: 0.360110
07-20 02:37 INFO     >> Global Model Test accuracy: 0.379690
07-20 02:37 INFO     in comm round:1
07-20 02:37 INFO     Training network 0. n_training: 1670
07-20 02:37 INFO     Training network 0
07-20 02:37 INFO     >> Pre-Training Training accuracy: 0.3
07-20 02:37 INFO     >> Pre-Training Test accuracy: 0.3796898449224612
