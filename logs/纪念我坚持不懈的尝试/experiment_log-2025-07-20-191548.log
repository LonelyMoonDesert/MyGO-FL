07-20 19:15 INFO     Namespace(model='resnet18', resume=True, ckpt_dir='./checkpoints', dataset='cifar10', net_config=None, partition='iid-diff-quantity', batch_size=32, lr=0.01, lr_G=0.008, lr_D=0.008, epochs=5, epoch_G=5, epoch_D=1, n_parties=5, alg='fedtopo', training_type='local', use_projection_head=False, out_dim=256, loss='contrastive', temperature=0.5, comm_round=10, is_same_initial=1, init_seed=0, dropout_p=0.0, datadir='../data/', reg=1e-05, l1_lambda=0.0001, l1=False, adv_l1_lambda=0.0001, adv_l1=False, lambda_adv=0.3, logdir='./logs/', modeldir='./models/', beta=0.5, device='cuda:0', log_file_name='experiment_log-2025-07-20-191548', optimizer='sgd', optimizer_G='sgd', optimizer_D='sgd', mu=0.01, noise=0.0, noise_type='level', rho=0.9, sample=1.0, scheduler='StepLR', scheduler_g='StepLR', scheduler_d='StepLR', gamma=0.01, step_size=30, milestones='30,60', T_max=50, factor=0.1, patience=10, base_lr=0.001, max_lr=0.01, step_size_up=2000, steps_per_epoch=1000, feature_layer='conv1', max_samples=1000, umap_dim=3, n_umap_batches=4)
07-20 19:15 INFO     cuda:0
07-20 19:15 INFO     ####################################################################################################
07-20 19:15 INFO     Partitioning data
07-20 19:15 INFO     Data statistics: {0: {0: 1954, 1: 1966, 2: 1962, 3: 1953, 4: 1966, 5: 1941, 6: 1921, 7: 1967, 8: 1952, 9: 2026}, 1: {0: 17, 1: 17, 2: 8, 3: 18, 4: 14, 5: 13, 6: 11, 7: 9, 8: 8, 9: 8}, 2: {0: 94, 1: 99, 2: 96, 3: 81, 4: 83, 5: 76, 6: 79, 7: 86, 8: 81, 9: 103}, 3: {0: 1570, 1: 1505, 2: 1565, 3: 1523, 4: 1544, 5: 1544, 6: 1605, 7: 1564, 8: 1514, 9: 1537}, 4: {0: 1365, 1: 1413, 2: 1369, 3: 1425, 4: 1393, 5: 1426, 6: 1384, 7: 1374, 8: 1445, 9: 1326}}
07-20 19:15 INFO     Getting global dataset using get_dataloader.
07-20 19:15 INFO     Initializing nets
07-20 19:16 INFO     in comm round:0
07-20 19:16 INFO     Training network 0. n_training: 19608
07-20 19:16 INFO     Training network 0
07-20 19:16 INFO     >> Pre-Training Training accuracy: 0.0
07-20 19:16 INFO     >> Pre-Training Test accuracy: 0.0
07-20 19:17 INFO     Epoch: 0 Total: 1.9611 CE: 1.8595 Topo: 2.0323
07-20 19:18 INFO     Epoch: 1 Total: 1.4821 CE: 1.3976 Topo: 1.6900
07-20 19:19 INFO     Epoch: 2 Total: 1.2301 CE: 1.1490 Topo: 1.6201
07-20 19:19 INFO     Epoch: 3 Total: 1.0520 CE: 0.9763 Topo: 1.5133
07-20 19:20 INFO     Epoch: 4 Total: 0.9129 CE: 0.8410 Topo: 1.4383
07-20 19:20 INFO     >> Training accuracy: 0.728121
07-20 19:20 INFO     >> Test accuracy: 0.724800
07-20 19:20 INFO      ** Training complete **
07-20 19:20 INFO     >> Last-batch PI Similarity: 0.9915
07-20 19:20 INFO     >> Last-batch Topo Distance: 1.5497
07-20 19:20 INFO     >> Last-batch 1-CKA: 0.6500
07-20 19:20 INFO     >> Last-batch Entropy: 0.766626
07-20 19:20 INFO     >> Last-batch SWD: 0.2350
07-20 19:20 INFO     net 0 final test acc 0.724800
07-20 19:20 INFO     Training network 1. n_training: 123
07-20 19:20 INFO     Training network 1
07-20 19:20 INFO     >> Pre-Training Training accuracy: 0.0
07-20 19:20 INFO     >> Pre-Training Test accuracy: 0.0
07-20 19:20 INFO     Epoch: 0 Total: 6.2337 CE: 6.0776 Topo: 3.1235
07-20 19:20 INFO     Epoch: 1 Total: 3.3909 CE: 3.2461 Topo: 2.8971
07-20 19:20 INFO     Epoch: 2 Total: 2.5814 CE: 2.4321 Topo: 2.9856
07-20 19:20 INFO     Epoch: 3 Total: 2.3053 CE: 2.1621 Topo: 2.8632
07-20 19:20 INFO     Epoch: 4 Total: 2.0742 CE: 1.9291 Topo: 2.9028
07-20 19:20 INFO     >> Training accuracy: 0.292683
07-20 19:20 INFO     >> Test accuracy: 0.176600
07-20 19:20 INFO      ** Training complete **
07-20 19:20 INFO     >> Last-batch PI Similarity: 0.9906
07-20 19:20 INFO     >> Last-batch Topo Distance: 3.1741
07-20 19:20 INFO     >> Last-batch 1-CKA: 0.5731
07-20 19:20 INFO     >> Last-batch Entropy: 1.801349
07-20 19:20 INFO     >> Last-batch SWD: 0.4896
07-20 19:20 INFO     net 1 final test acc 0.176600
07-20 19:20 INFO     Training network 2. n_training: 878
07-20 19:21 INFO     Training network 2
07-20 19:21 INFO     >> Pre-Training Training accuracy: 0.0
07-20 19:21 INFO     >> Pre-Training Test accuracy: 0.0
07-20 19:21 INFO     Epoch: 0 Total: 3.3437 CE: 3.2002 Topo: 2.8697
07-20 19:21 INFO     Epoch: 1 Total: 2.3090 CE: 2.1835 Topo: 2.5108
07-20 19:21 INFO     Epoch: 2 Total: 2.2162 CE: 2.0947 Topo: 2.4293
07-20 19:21 INFO     Epoch: 3 Total: 2.1232 CE: 2.0146 Topo: 2.1718
07-20 19:21 INFO     Epoch: 4 Total: 1.9847 CE: 1.8734 Topo: 2.2254
07-20 19:21 INFO     >> Training accuracy: 0.324601
07-20 19:21 INFO     >> Test accuracy: 0.311200
07-20 19:21 INFO      ** Training complete **
07-20 19:21 INFO     >> Last-batch PI Similarity: 0.9903
07-20 19:21 INFO     >> Last-batch Topo Distance: 3.3053
07-20 19:21 INFO     >> Last-batch 1-CKA: 0.6327
07-20 19:21 INFO     >> Last-batch Entropy: 1.428495
07-20 19:21 INFO     >> Last-batch SWD: 0.4438
07-20 19:21 INFO     net 2 final test acc 0.311200
07-20 19:21 INFO     Training network 3. n_training: 15471
07-20 19:21 INFO     Training network 3
07-20 19:21 INFO     >> Pre-Training Training accuracy: 0.0
07-20 19:21 INFO     >> Pre-Training Test accuracy: 0.0
07-20 19:22 INFO     Epoch: 0 Total: 2.0462 CE: 1.9235 Topo: 2.4534
07-20 19:23 INFO     Epoch: 1 Total: 1.5784 CE: 1.4798 Topo: 1.9710
07-20 19:24 INFO     Epoch: 2 Total: 1.3359 CE: 1.2431 Topo: 1.8565
07-20 19:25 INFO     Epoch: 3 Total: 1.1658 CE: 1.0780 Topo: 1.7569
07-20 19:26 INFO     Epoch: 4 Total: 1.0250 CE: 0.9452 Topo: 1.5960
07-20 19:27 INFO     >> Training accuracy: 0.690776
07-20 19:27 INFO     >> Test accuracy: 0.696400
07-20 19:27 INFO      ** Training complete **
07-20 19:27 INFO     >> Last-batch PI Similarity: 0.9913
07-20 19:27 INFO     >> Last-batch Topo Distance: 2.5725
07-20 19:27 INFO     >> Last-batch 1-CKA: 0.6424
07-20 19:27 INFO     >> Last-batch Entropy: 0.870006
07-20 19:27 INFO     >> Last-batch SWD: 0.3564
07-20 19:27 INFO     net 3 final test acc 0.696400
07-20 19:27 INFO     Training network 4. n_training: 13920
07-20 19:27 INFO     Training network 4
07-20 19:27 INFO     >> Pre-Training Training accuracy: 0.0
07-20 19:27 INFO     >> Pre-Training Test accuracy: 0.0
07-20 19:28 INFO     Epoch: 0 Total: 2.0629 CE: 1.9380 Topo: 2.4984
07-20 19:29 INFO     Epoch: 1 Total: 1.6129 CE: 1.5236 Topo: 1.7876
07-20 19:30 INFO     Epoch: 2 Total: 1.3717 CE: 1.2980 Topo: 1.4740
07-20 19:31 INFO     Epoch: 3 Total: 1.2084 CE: 1.1412 Topo: 1.3440
07-20 19:32 INFO     Epoch: 4 Total: 1.0766 CE: 1.0127 Topo: 1.2782
07-20 19:33 INFO     >> Training accuracy: 0.692385
07-20 19:33 INFO     >> Test accuracy: 0.689300
07-20 19:33 INFO      ** Training complete **
07-20 19:33 INFO     >> Last-batch PI Similarity: 0.9892
07-20 19:33 INFO     >> Last-batch Topo Distance: 1.0645
07-20 19:33 INFO     >> Last-batch 1-CKA: 0.6287
07-20 19:33 INFO     >> Last-batch Entropy: 1.041535
07-20 19:33 INFO     >> Last-batch SWD: 0.0857
07-20 19:33 INFO     net 4 final test acc 0.689300
07-20 19:33 INFO     global n_training: 1563
07-20 19:33 INFO     global n_test: 313
07-20 19:33 INFO     >> Global Model Train accuracy: 0.100000
07-20 19:33 INFO     >> Global Model Test accuracy: 0.100000
07-20 19:34 INFO     >> Global Model Entropy: 6.859507
07-20 19:34 INFO     in comm round:1
07-20 19:34 INFO     Training network 0. n_training: 19608
07-20 19:34 INFO     Training network 0
07-20 19:34 INFO     >> Pre-Training Training accuracy: 0.1003671970624235
07-20 19:34 INFO     >> Pre-Training Test accuracy: 0.1
07-20 19:35 INFO     Epoch: 0 Total: 1.5292 CE: 1.4612 Topo: 1.1326
07-20 19:36 INFO     Epoch: 1 Total: 1.1501 CE: 1.0793 Topo: 1.1810
07-20 19:36 INFO     Epoch: 2 Total: 1.0360 CE: 0.9588 Topo: 1.2857
07-20 19:37 INFO     Epoch: 3 Total: 0.9307 CE: 0.8516 Topo: 1.3181
07-20 19:38 INFO     Epoch: 4 Total: 0.8658 CE: 0.7791 Topo: 1.4441
07-20 19:39 INFO     >> Training accuracy: 0.726030
07-20 19:39 INFO     >> Test accuracy: 0.723800
07-20 19:39 INFO      ** Training complete **
07-20 19:39 INFO     >> Last-batch PI Similarity: 0.9943
07-20 19:39 INFO     >> Last-batch Topo Distance: 1.8758
07-20 19:39 INFO     >> Last-batch 1-CKA: 0.5882
07-20 19:39 INFO     >> Last-batch Entropy: 0.781952
07-20 19:39 INFO     >> Last-batch SWD: 0.3572
07-20 19:39 INFO     net 0 final test acc 0.723800
07-20 19:39 INFO     Training network 1. n_training: 123
07-20 19:39 INFO     Training network 1
07-20 19:39 INFO     >> Pre-Training Training accuracy: 0.11382113821138211
07-20 19:39 INFO     >> Pre-Training Test accuracy: 0.1
07-20 19:39 INFO     Epoch: 0 Total: 2.7819 CE: 2.7379 Topo: 0.7335
07-20 19:39 INFO     Epoch: 1 Total: 2.3991 CE: 2.2789 Topo: 2.0039
07-20 19:39 INFO     Epoch: 2 Total: 2.3332 CE: 2.2607 Topo: 1.2094
07-20 19:39 INFO     Epoch: 3 Total: 2.0138 CE: 1.9309 Topo: 1.3813
07-20 19:39 INFO     Epoch: 4 Total: 1.7437 CE: 1.6578 Topo: 1.4313
07-20 19:39 INFO     >> Training accuracy: 0.447154
07-20 19:39 INFO     >> Test accuracy: 0.397200
07-20 19:39 INFO      ** Training complete **
07-20 19:39 INFO     >> Last-batch PI Similarity: 0.9909
07-20 19:39 INFO     >> Last-batch Topo Distance: 1.4174
07-20 19:39 INFO     >> Last-batch 1-CKA: 0.6919
07-20 19:39 INFO     >> Last-batch Entropy: 1.732769
07-20 19:39 INFO     >> Last-batch SWD: 0.1009
07-20 19:39 INFO     net 1 final test acc 0.397200
07-20 19:39 INFO     Training network 2. n_training: 878
07-20 19:39 INFO     Training network 2
07-20 19:39 INFO     >> Pre-Training Training accuracy: 0.09453302961275627
07-20 19:39 INFO     >> Pre-Training Test accuracy: 0.1
07-20 19:39 INFO     Epoch: 0 Total: 2.3425 CE: 2.2465 Topo: 1.6008
07-20 19:39 INFO     Epoch: 1 Total: 1.9531 CE: 1.8779 Topo: 1.2533
07-20 19:39 INFO     Epoch: 2 Total: 1.7721 CE: 1.6989 Topo: 1.2208
07-20 19:39 INFO     Epoch: 3 Total: 1.7309 CE: 1.6611 Topo: 1.1625
07-20 19:39 INFO     Epoch: 4 Total: 1.6688 CE: 1.5954 Topo: 1.2238
07-20 19:39 INFO     >> Training accuracy: 0.447608
07-20 19:39 INFO     >> Test accuracy: 0.447000
07-20 19:39 INFO      ** Training complete **
07-20 19:39 INFO     >> Last-batch PI Similarity: 0.9947
07-20 19:39 INFO     >> Last-batch Topo Distance: 1.9646
07-20 19:39 INFO     >> Last-batch 1-CKA: 0.6043
07-20 19:39 INFO     >> Last-batch Entropy: 1.561790
07-20 19:39 INFO     >> Last-batch SWD: 0.1271
07-20 19:39 INFO     net 2 final test acc 0.447000
07-20 19:39 INFO     Training network 3. n_training: 15471
07-20 19:40 INFO     Training network 3
07-20 19:40 INFO     >> Pre-Training Training accuracy: 0.09979962510503523
07-20 19:40 INFO     >> Pre-Training Test accuracy: 0.1
